import{b,e as A,w as fe,f as V,o as U,g as y,t as k,l as he,D as W,E as Ne,F as Ve,q as Ue,G as ee,n as Ye,s as ue,H as Xe,k as Oe,i as ge,x as ke}from"./vendor-CnP4LbDf.js";import{c as We,i as R,E as qe,p as Fe,a as $e,b as Ge,d as ze,g as Be,e as _,I as B,f as le,h as Ke,j as re,k as ae,t as Qe,l as ie,m as Ee,n as H,o as Se,q as De,r as $,s as G,u as Ze,v as pe,w as Te,x as te,y as Je,z as et,A as tt,B as ye,C as it,D as st,F as nt,G as lt,H as rt,J as at,K as ot,L as we,M as oe,W as dt,N as ct,O as ht,S as ut,P as gt,Q as pt,R as vt,T as mt,U as ft}from"./calendar-BiykKK6j.js";import{_ as be,u as Et,c as x,f as St,p as Dt,q as Tt,r as yt,s as wt,v as bt,g as ve,C as q,w as Ct,l as Mt,L as Rt}from"./index-B_XrOJYt.js";import"./utils-BuJoAw0M.js";oe.touchMouseIgnoreWait=500;let se=0,z=0,ne=!1;class Ce{constructor(e){this.subjectEl=null,this.selector="",this.handleSelector="",this.shouldIgnoreMove=!1,this.shouldWatchScroll=!0,this.isDragging=!1,this.isTouchDragging=!1,this.wasTouchScroll=!1,this.handleMouseDown=t=>{if(!this.shouldIgnoreMouse()&&jt(t)&&this.tryStart(t)){let i=this.createEventFromMouse(t,!0);this.emitter.trigger("pointerdown",i),this.initScrollWatch(i),this.shouldIgnoreMove||document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp)}},this.handleMouseMove=t=>{let i=this.createEventFromMouse(t);this.recordCoords(i),this.emitter.trigger("pointermove",i)},this.handleMouseUp=t=>{document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),this.emitter.trigger("pointerup",this.createEventFromMouse(t)),this.cleanup()},this.handleTouchStart=t=>{if(this.tryStart(t)){this.isTouchDragging=!0;let i=this.createEventFromTouch(t,!0);this.emitter.trigger("pointerdown",i),this.initScrollWatch(i);let n=t.target;this.shouldIgnoreMove||n.addEventListener("touchmove",this.handleTouchMove),n.addEventListener("touchend",this.handleTouchEnd),n.addEventListener("touchcancel",this.handleTouchEnd),window.addEventListener("scroll",this.handleTouchScroll,!0)}},this.handleTouchMove=t=>{let i=this.createEventFromTouch(t);this.recordCoords(i),this.emitter.trigger("pointermove",i)},this.handleTouchEnd=t=>{if(this.isDragging){let i=t.target;i.removeEventListener("touchmove",this.handleTouchMove),i.removeEventListener("touchend",this.handleTouchEnd),i.removeEventListener("touchcancel",this.handleTouchEnd),window.removeEventListener("scroll",this.handleTouchScroll,!0),this.emitter.trigger("pointerup",this.createEventFromTouch(t)),this.cleanup(),this.isTouchDragging=!1,It()}},this.handleTouchScroll=()=>{this.wasTouchScroll=!0},this.handleScroll=t=>{if(!this.shouldIgnoreMove){let i=window.scrollX-this.prevScrollX+this.prevPageX,n=window.scrollY-this.prevScrollY+this.prevPageY;this.emitter.trigger("pointermove",{origEvent:t,isTouch:this.isTouchDragging,subjectEl:this.subjectEl,pageX:i,pageY:n,deltaX:i-this.origPageX,deltaY:n-this.origPageY})}},this.containerEl=e,this.emitter=new Te,e.addEventListener("mousedown",this.handleMouseDown),e.addEventListener("touchstart",this.handleTouchStart,{passive:!0}),Pt()}destroy(){this.containerEl.removeEventListener("mousedown",this.handleMouseDown),this.containerEl.removeEventListener("touchstart",this.handleTouchStart,{passive:!0}),xt()}tryStart(e){let t=this.querySubjectEl(e),i=e.target;return t&&(!this.handleSelector||_(i,this.handleSelector))?(this.subjectEl=t,this.isDragging=!0,this.wasTouchScroll=!1,!0):!1}cleanup(){ne=!1,this.isDragging=!1,this.subjectEl=null,this.destroyScrollWatch()}querySubjectEl(e){return this.selector?_(e.target,this.selector):this.containerEl}shouldIgnoreMouse(){return se||this.isTouchDragging}cancelTouchScroll(){this.isDragging&&(ne=!0)}initScrollWatch(e){this.shouldWatchScroll&&(this.recordCoords(e),window.addEventListener("scroll",this.handleScroll,!0))}recordCoords(e){this.shouldWatchScroll&&(this.prevPageX=e.pageX,this.prevPageY=e.pageY,this.prevScrollX=window.scrollX,this.prevScrollY=window.scrollY)}destroyScrollWatch(){this.shouldWatchScroll&&window.removeEventListener("scroll",this.handleScroll,!0)}createEventFromMouse(e,t){let i=0,n=0;return t?(this.origPageX=e.pageX,this.origPageY=e.pageY):(i=e.pageX-this.origPageX,n=e.pageY-this.origPageY),{origEvent:e,isTouch:!1,subjectEl:this.subjectEl,pageX:e.pageX,pageY:e.pageY,deltaX:i,deltaY:n}}createEventFromTouch(e,t){let i=e.touches,n,a,s=0,l=0;return i&&i.length?(n=i[0].pageX,a=i[0].pageY):(n=e.pageX,a=e.pageY),t?(this.origPageX=n,this.origPageY=a):(s=n-this.origPageX,l=a-this.origPageY),{origEvent:e,isTouch:!0,subjectEl:this.subjectEl,pageX:n,pageY:a,deltaX:s,deltaY:l}}}function jt(d){return d.button===0&&!d.ctrlKey}function It(){se+=1,setTimeout(()=>{se-=1},oe.touchMouseIgnoreWait)}function Pt(){z+=1,z===1&&window.addEventListener("touchmove",Me,{passive:!1})}function xt(){z-=1,z||window.removeEventListener("touchmove",Me,{passive:!1})}function Me(d){ne&&d.preventDefault()}class Lt{constructor(){this.isVisible=!1,this.sourceEl=null,this.mirrorEl=null,this.sourceElRect=null,this.parentNode=document.body,this.zIndex=9999,this.revertDuration=0}start(e,t,i){this.sourceEl=e,this.sourceElRect=this.sourceEl.getBoundingClientRect(),this.origScreenX=t-window.scrollX,this.origScreenY=i-window.scrollY,this.deltaX=0,this.deltaY=0,this.updateElPosition()}handleMove(e,t){this.deltaX=e-window.scrollX-this.origScreenX,this.deltaY=t-window.scrollY-this.origScreenY,this.updateElPosition()}setIsVisible(e){e?this.isVisible||(this.mirrorEl&&(this.mirrorEl.style.display=""),this.isVisible=e,this.updateElPosition()):this.isVisible&&(this.mirrorEl&&(this.mirrorEl.style.display="none"),this.isVisible=e)}stop(e,t){let i=()=>{this.cleanup(),t()};e&&this.mirrorEl&&this.isVisible&&this.revertDuration&&(this.deltaX||this.deltaY)?this.doRevertAnimation(i,this.revertDuration):setTimeout(i,0)}doRevertAnimation(e,t){let i=this.mirrorEl,n=this.sourceEl.getBoundingClientRect();i.style.transition="top "+t+"ms,left "+t+"ms",te(i,{left:n.left,top:n.top}),Je(i,()=>{i.style.transition="",e()})}cleanup(){this.mirrorEl&&(et(this.mirrorEl),this.mirrorEl=null),this.sourceEl=null}updateElPosition(){this.sourceEl&&this.isVisible&&te(this.getMirrorEl(),{left:this.sourceElRect.left+this.deltaX,top:this.sourceElRect.top+this.deltaY})}getMirrorEl(){let e=this.sourceElRect,t=this.mirrorEl;return t||(t=this.mirrorEl=this.sourceEl.cloneNode(!0),t.style.userSelect="none",t.style.webkitUserSelect="none",t.style.pointerEvents="none",t.classList.add("fc-event-dragging"),te(t,{position:"fixed",zIndex:this.zIndex,visibility:"",boxSizing:"border-box",width:e.right-e.left,height:e.bottom-e.top,right:"auto",bottom:"auto",margin:0}),this.parentNode.appendChild(t)),t}}class Re extends ut{constructor(e,t){super(),this.handleScroll=()=>{this.scrollTop=this.scrollController.getScrollTop(),this.scrollLeft=this.scrollController.getScrollLeft(),this.handleScrollChange()},this.scrollController=e,this.doesListening=t,this.scrollTop=this.origScrollTop=e.getScrollTop(),this.scrollLeft=this.origScrollLeft=e.getScrollLeft(),this.scrollWidth=e.getScrollWidth(),this.scrollHeight=e.getScrollHeight(),this.clientWidth=e.getClientWidth(),this.clientHeight=e.getClientHeight(),this.clientRect=this.computeClientRect(),this.doesListening&&this.getEventTarget().addEventListener("scroll",this.handleScroll)}destroy(){this.doesListening&&this.getEventTarget().removeEventListener("scroll",this.handleScroll)}getScrollTop(){return this.scrollTop}getScrollLeft(){return this.scrollLeft}setScrollTop(e){this.scrollController.setScrollTop(e),this.doesListening||(this.scrollTop=Math.max(Math.min(e,this.getMaxScrollTop()),0),this.handleScrollChange())}setScrollLeft(e){this.scrollController.setScrollLeft(e),this.doesListening||(this.scrollLeft=Math.max(Math.min(e,this.getMaxScrollLeft()),0),this.handleScrollChange())}getClientWidth(){return this.clientWidth}getClientHeight(){return this.clientHeight}getScrollWidth(){return this.scrollWidth}getScrollHeight(){return this.scrollHeight}handleScrollChange(){}}class je extends Re{constructor(e,t){super(new ct(e),t)}getEventTarget(){return this.scrollController.el}computeClientRect(){return ht(this.scrollController.el)}}class At extends Re{constructor(e){super(new dt,e)}getEventTarget(){return window}computeClientRect(){return{left:this.scrollLeft,right:this.scrollLeft+this.clientWidth,top:this.scrollTop,bottom:this.scrollTop+this.clientHeight}}handleScrollChange(){this.clientRect=this.computeClientRect()}}const me=typeof performance=="function"?performance.now:Date.now;class Ht{constructor(){this.isEnabled=!0,this.scrollQuery=[window,".fc-scroller"],this.edgeThreshold=50,this.maxVelocity=300,this.pointerScreenX=null,this.pointerScreenY=null,this.isAnimating=!1,this.scrollCaches=null,this.everMovedUp=!1,this.everMovedDown=!1,this.everMovedLeft=!1,this.everMovedRight=!1,this.animate=()=>{if(this.isAnimating){let e=this.computeBestEdge(this.pointerScreenX+window.scrollX,this.pointerScreenY+window.scrollY);if(e){let t=me();this.handleSide(e,(t-this.msSinceRequest)/1e3),this.requestAnimation(t)}else this.isAnimating=!1}}}start(e,t,i){this.isEnabled&&(this.scrollCaches=this.buildCaches(i),this.pointerScreenX=null,this.pointerScreenY=null,this.everMovedUp=!1,this.everMovedDown=!1,this.everMovedLeft=!1,this.everMovedRight=!1,this.handleMove(e,t))}handleMove(e,t){if(this.isEnabled){let i=e-window.scrollX,n=t-window.scrollY,a=this.pointerScreenY===null?0:n-this.pointerScreenY,s=this.pointerScreenX===null?0:i-this.pointerScreenX;a<0?this.everMovedUp=!0:a>0&&(this.everMovedDown=!0),s<0?this.everMovedLeft=!0:s>0&&(this.everMovedRight=!0),this.pointerScreenX=i,this.pointerScreenY=n,this.isAnimating||(this.isAnimating=!0,this.requestAnimation(me()))}}stop(){if(this.isEnabled){this.isAnimating=!1;for(let e of this.scrollCaches)e.destroy();this.scrollCaches=null}}requestAnimation(e){this.msSinceRequest=e,requestAnimationFrame(this.animate)}handleSide(e,t){let{scrollCache:i}=e,{edgeThreshold:n}=this,a=n-e.distance,s=a*a/(n*n)*this.maxVelocity*t,l=1;switch(e.name){case"left":l=-1;case"right":i.setScrollLeft(i.getScrollLeft()+s*l);break;case"top":l=-1;case"bottom":i.setScrollTop(i.getScrollTop()+s*l);break}}computeBestEdge(e,t){let{edgeThreshold:i}=this,n=null,a=this.scrollCaches||[];for(let s of a){let l=s.clientRect,r=e-l.left,o=l.right-e,h=t-l.top,c=l.bottom-t;r>=0&&o>=0&&h>=0&&c>=0&&(h<=i&&this.everMovedUp&&s.canScrollUp()&&(!n||n.distance>h)&&(n={scrollCache:s,name:"top",distance:h}),c<=i&&this.everMovedDown&&s.canScrollDown()&&(!n||n.distance>c)&&(n={scrollCache:s,name:"bottom",distance:c}),r<=i&&this.everMovedLeft&&s.canScrollLeft()&&(!n||n.distance>r)&&(n={scrollCache:s,name:"left",distance:r}),o<=i&&this.everMovedRight&&s.canScrollRight()&&(!n||n.distance>o)&&(n={scrollCache:s,name:"right",distance:o}))}return n}buildCaches(e){return this.queryScrollEls(e).map(t=>t===window?new At(!1):new je(t,!1))}queryScrollEls(e){let t=[];for(let i of this.scrollQuery)typeof i=="object"?t.push(i):t.push(...Array.prototype.slice.call(e.getRootNode().querySelectorAll(i)));return t}}class X extends qe{constructor(e,t){super(e),this.containerEl=e,this.delay=null,this.minDistance=0,this.touchScrollAllowed=!0,this.mirrorNeedsRevert=!1,this.isInteracting=!1,this.isDragging=!1,this.isDelayEnded=!1,this.isDistanceSurpassed=!1,this.delayTimeoutId=null,this.onPointerDown=n=>{this.isDragging||(this.isInteracting=!0,this.isDelayEnded=!1,this.isDistanceSurpassed=!1,Fe(document.body),$e(document.body),n.isTouch||n.origEvent.preventDefault(),this.emitter.trigger("pointerdown",n),this.isInteracting&&!this.pointer.shouldIgnoreMove&&(this.mirror.setIsVisible(!1),this.mirror.start(n.subjectEl,n.pageX,n.pageY),this.startDelay(n),this.minDistance||this.handleDistanceSurpassed(n)))},this.onPointerMove=n=>{if(this.isInteracting){if(this.emitter.trigger("pointermove",n),!this.isDistanceSurpassed){let a=this.minDistance,s,{deltaX:l,deltaY:r}=n;s=l*l+r*r,s>=a*a&&this.handleDistanceSurpassed(n)}this.isDragging&&(n.origEvent.type!=="scroll"&&(this.mirror.handleMove(n.pageX,n.pageY),this.autoScroller.handleMove(n.pageX,n.pageY)),this.emitter.trigger("dragmove",n))}},this.onPointerUp=n=>{this.isInteracting&&(this.isInteracting=!1,Ge(document.body),ze(document.body),this.emitter.trigger("pointerup",n),this.isDragging&&(this.autoScroller.stop(),this.tryStopDrag(n)),this.delayTimeoutId&&(clearTimeout(this.delayTimeoutId),this.delayTimeoutId=null))};let i=this.pointer=new Ce(e);i.emitter.on("pointerdown",this.onPointerDown),i.emitter.on("pointermove",this.onPointerMove),i.emitter.on("pointerup",this.onPointerUp),t&&(i.selector=t),this.mirror=new Lt,this.autoScroller=new Ht}destroy(){this.pointer.destroy(),this.onPointerUp({})}startDelay(e){typeof this.delay=="number"?this.delayTimeoutId=setTimeout(()=>{this.delayTimeoutId=null,this.handleDelayEnd(e)},this.delay):this.handleDelayEnd(e)}handleDelayEnd(e){this.isDelayEnded=!0,this.tryStartDrag(e)}handleDistanceSurpassed(e){this.isDistanceSurpassed=!0,this.tryStartDrag(e)}tryStartDrag(e){this.isDelayEnded&&this.isDistanceSurpassed&&(!this.pointer.wasTouchScroll||this.touchScrollAllowed)&&(this.isDragging=!0,this.mirrorNeedsRevert=!1,this.autoScroller.start(e.pageX,e.pageY,this.containerEl),this.emitter.trigger("dragstart",e),this.touchScrollAllowed===!1&&this.pointer.cancelTouchScroll())}tryStopDrag(e){this.mirror.stop(this.mirrorNeedsRevert,this.stopDrag.bind(this,e))}stopDrag(e){this.isDragging=!1,this.emitter.trigger("dragend",e)}setIgnoreMove(e){this.pointer.shouldIgnoreMove=e}setMirrorIsVisible(e){this.mirror.setIsVisible(e)}setMirrorNeedsRevert(e){this.mirrorNeedsRevert=e}setAutoScrollEnabled(e){this.autoScroller.isEnabled=e}}class _t{constructor(e){this.el=e,this.origRect=ye(e),this.scrollCaches=pt(e).map(t=>new je(t,!0))}destroy(){for(let e of this.scrollCaches)e.destroy()}computeLeft(){let e=this.origRect.left;for(let t of this.scrollCaches)e+=t.origScrollLeft-t.getScrollLeft();return e}computeTop(){let e=this.origRect.top;for(let t of this.scrollCaches)e+=t.origScrollTop-t.getScrollTop();return e}isWithinClipping(e,t){let i={left:e,top:t};for(let n of this.scrollCaches)if(!Nt(n.getEventTarget())&&!vt(i,n.clientRect))return!1;return!0}}function Nt(d){let e=d.tagName;return e==="HTML"||e==="BODY"}class K{constructor(e,t){this.useSubjectCenter=!1,this.requireInitial=!0,this.disablePointCheck=!1,this.initialHit=null,this.movingHit=null,this.finalHit=null,this.handlePointerDown=i=>{let{dragging:n}=this;this.initialHit=null,this.movingHit=null,this.finalHit=null,this.prepareHits(),this.processFirstCoord(i),this.initialHit||!this.requireInitial?(n.setIgnoreMove(!1),this.emitter.trigger("pointerdown",i)):n.setIgnoreMove(!0)},this.handleDragStart=i=>{this.emitter.trigger("dragstart",i),this.handleMove(i,!0)},this.handleDragMove=i=>{this.emitter.trigger("dragmove",i),this.handleMove(i)},this.handlePointerUp=i=>{this.releaseHits(),this.emitter.trigger("pointerup",i)},this.handleDragEnd=i=>{this.movingHit&&this.emitter.trigger("hitupdate",null,!0,i),this.finalHit=this.movingHit,this.movingHit=null,this.emitter.trigger("dragend",i)},this.droppableStore=t,e.emitter.on("pointerdown",this.handlePointerDown),e.emitter.on("dragstart",this.handleDragStart),e.emitter.on("dragmove",this.handleDragMove),e.emitter.on("pointerup",this.handlePointerUp),e.emitter.on("dragend",this.handleDragEnd),this.dragging=e,this.emitter=new Te}processFirstCoord(e){let t={left:e.pageX,top:e.pageY},i=t,n=e.subjectEl,a;n instanceof HTMLElement&&(a=ye(n),i=it(i,a));let s=this.initialHit=this.queryHitForOffset(i.left,i.top);if(s){if(this.useSubjectCenter&&a){let l=st(a,s.rect);l&&(i=nt(l))}this.coordAdjust=lt(i,t)}else this.coordAdjust={left:0,top:0}}handleMove(e,t){let i=this.queryHitForOffset(e.pageX+this.coordAdjust.left,e.pageY+this.coordAdjust.top);(t||!Q(this.movingHit,i))&&(this.movingHit=i,this.emitter.trigger("hitupdate",i,!1,e))}prepareHits(){this.offsetTrackers=rt(this.droppableStore,e=>(e.component.prepareHits(),new _t(e.el)))}releaseHits(){let{offsetTrackers:e}=this;for(let t in e)e[t].destroy();this.offsetTrackers={}}queryHitForOffset(e,t){let{droppableStore:i,offsetTrackers:n}=this,a=null;for(let s in i){let l=i[s].component,r=n[s];if(r&&r.isWithinClipping(e,t)){let o=r.computeLeft(),h=r.computeTop(),c=e-o,p=t-h,{origRect:S}=r,w=S.right-S.left,m=S.bottom-S.top;if(c>=0&&c<w&&p>=0&&p<m){let D=l.queryHit(c,p,w,m);D&&at(D.dateProfile.activeRange,D.dateSpan.range)&&(this.disablePointCheck||r.el.contains(r.el.getRootNode().elementFromPoint(c+o-window.scrollX,p+h-window.scrollY)))&&(!a||D.layer>a.layer)&&(D.componentId=s,D.context=l.context,D.rect.left+=o,D.rect.right+=o,D.rect.top+=h,D.rect.bottom+=h,a=D)}}}return a}}function Q(d,e){return!d&&!e?!0:!!d!=!!e?!1:tt(d.dateSpan,e.dateSpan)}function Ie(d,e){let t={};for(let i of e.pluginHooks.datePointTransforms)Object.assign(t,i(d,e));return Object.assign(t,Vt(d,e.dateEnv)),t}function Vt(d,e){return{date:e.toDate(d.range.start),dateStr:e.formatIso(d.range.start,{omitTime:d.allDay}),allDay:d.allDay}}class Ut extends B{constructor(e){super(e),this.handlePointerDown=i=>{let{dragging:n}=this,a=i.origEvent.target;n.setIgnoreMove(!this.component.isValidDateDownEl(a))},this.handleDragEnd=i=>{let{component:n}=this,{pointer:a}=this.dragging;if(!a.wasTouchScroll){let{initialHit:s,finalHit:l}=this.hitDragging;if(s&&l&&Q(s,l)){let{context:r}=n,o=Object.assign(Object.assign({},Ie(s.dateSpan,r)),{dayEl:s.dayEl,jsEvent:i.origEvent,view:r.viewApi||r.calendarApi.view});r.emitter.trigger("dateClick",o)}}},this.dragging=new X(e.el),this.dragging.autoScroller.isEnabled=!1;let t=this.hitDragging=new K(this.dragging,le(e));t.emitter.on("pointerdown",this.handlePointerDown),t.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}}class Yt extends B{constructor(e){super(e),this.dragSelection=null,this.handlePointerDown=s=>{let{component:l,dragging:r}=this,{options:o}=l.context,h=o.selectable&&l.isValidDateDownEl(s.origEvent.target);r.setIgnoreMove(!h),r.delay=s.isTouch?Xt(l):null},this.handleDragStart=s=>{this.component.context.calendarApi.unselect(s)},this.handleHitUpdate=(s,l)=>{let{context:r}=this.component,o=null,h=!1;if(s){let c=this.hitDragging.initialHit;s.componentId===c.componentId&&this.isHitComboAllowed&&!this.isHitComboAllowed(c,s)||(o=Ot(c,s,r.pluginHooks.dateSelectionTransformers)),(!o||!Ke(o,s.dateProfile,r))&&(h=!0,o=null)}o?r.dispatch({type:"SELECT_DATES",selection:o}):l||r.dispatch({type:"UNSELECT_DATES"}),h?ae():re(),l||(this.dragSelection=o)},this.handlePointerUp=s=>{this.dragSelection&&(Qe(this.dragSelection,s,this.component.context),this.dragSelection=null)};let{component:t}=e,{options:i}=t.context,n=this.dragging=new X(e.el);n.touchScrollAllowed=!1,n.minDistance=i.selectMinDistance||0,n.autoScroller.isEnabled=i.dragScroll;let a=this.hitDragging=new K(this.dragging,le(e));a.emitter.on("pointerdown",this.handlePointerDown),a.emitter.on("dragstart",this.handleDragStart),a.emitter.on("hitupdate",this.handleHitUpdate),a.emitter.on("pointerup",this.handlePointerUp)}destroy(){this.dragging.destroy()}}function Xt(d){let{options:e}=d.context,t=e.selectLongPressDelay;return t==null&&(t=e.longPressDelay),t}function Ot(d,e,t){let i=d.dateSpan,n=e.dateSpan,a=[i.range.start,i.range.end,n.range.start,n.range.end];a.sort(gt);let s={};for(let l of t){let r=l(d,e);if(r===!1)return null;r&&Object.assign(s,r)}return s.range={start:a[0],end:a[3]},s.allDay=i.allDay,s}class O extends B{constructor(e){super(e),this.subjectEl=null,this.subjectSeg=null,this.isDragging=!1,this.eventRange=null,this.relevantEvents=null,this.receivingContext=null,this.validMutation=null,this.mutatedRelevantEvents=null,this.handlePointerDown=s=>{let l=s.origEvent.target,{component:r,dragging:o}=this,{mirror:h}=o,{options:c}=r.context,p=r.context;this.subjectEl=s.subjectEl;let S=this.subjectSeg=ie(s.subjectEl),m=(this.eventRange=S.eventRange).instance.instanceId;this.relevantEvents=Ee(p.getCurrentData().eventStore,m),o.minDistance=s.isTouch?0:c.eventDragMinDistance,o.delay=s.isTouch&&m!==r.props.eventSelection?Wt(r):null,c.fixedMirrorParent?h.parentNode=c.fixedMirrorParent:h.parentNode=_(l,".fc"),h.revertDuration=c.dragRevertDuration;let D=r.isValidSegDownEl(l)&&!_(l,".fc-event-resizer");o.setIgnoreMove(!D),this.isDragging=D&&s.subjectEl.classList.contains("fc-event-draggable")},this.handleDragStart=s=>{let l=this.component.context,r=this.eventRange,o=r.instance.instanceId;s.isTouch?o!==this.component.props.eventSelection&&l.dispatch({type:"SELECT_EVENT",eventInstanceId:o}):l.dispatch({type:"UNSELECT_EVENT"}),this.isDragging&&(l.calendarApi.unselect(s),l.emitter.trigger("eventDragStart",{el:this.subjectEl,event:new H(l,r.def,r.instance),jsEvent:s.origEvent,view:l.viewApi}))},this.handleHitUpdate=(s,l)=>{if(!this.isDragging)return;let r=this.relevantEvents,o=this.hitDragging.initialHit,h=this.component.context,c=null,p=null,S=null,w=!1,m={affectedEvents:r,mutatedEvents:$(),isEvent:!0};if(s){c=s.context;let D=c.options;h===c||D.editable&&D.droppable?(p=kt(o,s,this.eventRange.instance.range.start,c.getCurrentData().pluginHooks.eventDragMutationMassagers),p&&(S=Se(r,c.getCurrentData().eventUiBases,p,c),m.mutatedEvents=S,De(m,s.dateProfile,c)||(w=!0,p=null,S=null,m.mutatedEvents=$()))):c=null}this.displayDrag(c,m),w?ae():re(),l||(h===c&&Q(o,s)&&(p=null),this.dragging.setMirrorNeedsRevert(!p),this.dragging.setMirrorIsVisible(!s||!this.subjectEl.getRootNode().querySelector(".fc-event-mirror")),this.receivingContext=c,this.validMutation=p,this.mutatedRelevantEvents=S)},this.handlePointerUp=()=>{this.isDragging||this.cleanup()},this.handleDragEnd=s=>{if(this.isDragging){let l=this.component.context,r=l.viewApi,{receivingContext:o,validMutation:h}=this,c=this.eventRange.def,p=this.eventRange.instance,S=new H(l,c,p),w=this.relevantEvents,m=this.mutatedRelevantEvents,{finalHit:D}=this.hitDragging;if(this.clearDrag(),l.emitter.trigger("eventDragStop",{el:this.subjectEl,event:S,jsEvent:s.origEvent,view:r}),h){if(o===l){let j=new H(l,m.defs[c.defId],p?m.instances[p.instanceId]:null);l.dispatch({type:"MERGE_EVENTS",eventStore:m});let I={oldEvent:S,event:j,relatedEvents:G(m,l,p),revert(){l.dispatch({type:"MERGE_EVENTS",eventStore:w})}},C={};for(let f of l.getCurrentData().pluginHooks.eventDropTransformers)Object.assign(C,f(h,l));l.emitter.trigger("eventDrop",Object.assign(Object.assign(Object.assign({},I),C),{el:s.subjectEl,delta:h.datesDelta,jsEvent:s.origEvent,view:r})),l.emitter.trigger("eventChange",I)}else if(o){let j={event:S,relatedEvents:G(w,l,p),revert(){l.dispatch({type:"MERGE_EVENTS",eventStore:w})}};l.emitter.trigger("eventLeave",Object.assign(Object.assign({},j),{draggedEl:s.subjectEl,view:r})),l.dispatch({type:"REMOVE_EVENTS",eventStore:w}),l.emitter.trigger("eventRemove",j);let I=m.defs[c.defId],C=m.instances[p.instanceId],f=new H(o,I,C);o.dispatch({type:"MERGE_EVENTS",eventStore:m});let u={event:f,relatedEvents:G(m,o,C),revert(){o.dispatch({type:"REMOVE_EVENTS",eventStore:m})}};o.emitter.trigger("eventAdd",u),s.isTouch&&o.dispatch({type:"SELECT_EVENT",eventInstanceId:p.instanceId}),o.emitter.trigger("drop",Object.assign(Object.assign({},Ie(D.dateSpan,o)),{draggedEl:s.subjectEl,jsEvent:s.origEvent,view:D.context.viewApi})),o.emitter.trigger("eventReceive",Object.assign(Object.assign({},u),{draggedEl:s.subjectEl,view:D.context.viewApi}))}}else l.emitter.trigger("_noEventDrop")}this.cleanup()};let{component:t}=this,{options:i}=t.context,n=this.dragging=new X(e.el);n.pointer.selector=O.SELECTOR,n.touchScrollAllowed=!1,n.autoScroller.isEnabled=i.dragScroll;let a=this.hitDragging=new K(this.dragging,Ze);a.useSubjectCenter=e.useEventCenter,a.emitter.on("pointerdown",this.handlePointerDown),a.emitter.on("dragstart",this.handleDragStart),a.emitter.on("hitupdate",this.handleHitUpdate),a.emitter.on("pointerup",this.handlePointerUp),a.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}displayDrag(e,t){let i=this.component.context,n=this.receivingContext;n&&n!==e&&(n===i?n.dispatch({type:"SET_EVENT_DRAG",state:{affectedEvents:t.affectedEvents,mutatedEvents:$(),isEvent:!0}}):n.dispatch({type:"UNSET_EVENT_DRAG"})),e&&e.dispatch({type:"SET_EVENT_DRAG",state:t})}clearDrag(){let e=this.component.context,{receivingContext:t}=this;t&&t.dispatch({type:"UNSET_EVENT_DRAG"}),e!==t&&e.dispatch({type:"UNSET_EVENT_DRAG"})}cleanup(){this.subjectSeg=null,this.isDragging=!1,this.eventRange=null,this.relevantEvents=null,this.receivingContext=null,this.validMutation=null,this.mutatedRelevantEvents=null}}O.SELECTOR=".fc-event-draggable, .fc-event-resizable";function kt(d,e,t,i){let n=d.dateSpan,a=e.dateSpan,s=n.range.start,l=a.range.start,r={};n.allDay!==a.allDay&&(r.allDay=a.allDay,r.hasEnd=e.context.options.allDayMaintainDuration,a.allDay?s=ot(t):s=t);let o=we(s,l,d.context.dateEnv,d.componentId===e.componentId?d.largeUnit:null);o.milliseconds&&(r.allDay=!1);let h={datesDelta:o,standardProps:r};for(let c of i)c(h,d,e);return h}function Wt(d){let{options:e}=d.context,t=e.eventLongPressDelay;return t==null&&(t=e.longPressDelay),t}class qt extends B{constructor(e){super(e),this.draggingSegEl=null,this.draggingSeg=null,this.eventRange=null,this.relevantEvents=null,this.validMutation=null,this.mutatedRelevantEvents=null,this.handlePointerDown=a=>{let{component:s}=this,l=this.querySegEl(a),r=ie(l),o=this.eventRange=r.eventRange;this.dragging.minDistance=s.context.options.eventDragMinDistance,this.dragging.setIgnoreMove(!this.component.isValidSegDownEl(a.origEvent.target)||a.isTouch&&this.component.props.eventSelection!==o.instance.instanceId)},this.handleDragStart=a=>{let{context:s}=this.component,l=this.eventRange;this.relevantEvents=Ee(s.getCurrentData().eventStore,this.eventRange.instance.instanceId);let r=this.querySegEl(a);this.draggingSegEl=r,this.draggingSeg=ie(r),s.calendarApi.unselect(),s.emitter.trigger("eventResizeStart",{el:r,event:new H(s,l.def,l.instance),jsEvent:a.origEvent,view:s.viewApi})},this.handleHitUpdate=(a,s,l)=>{let{context:r}=this.component,o=this.relevantEvents,h=this.hitDragging.initialHit,c=this.eventRange.instance,p=null,S=null,w=!1,m={affectedEvents:o,mutatedEvents:$(),isEvent:!0};a&&(a.componentId===h.componentId&&this.isHitComboAllowed&&!this.isHitComboAllowed(h,a)||(p=Ft(h,a,l.subjectEl.classList.contains("fc-event-resizer-start"),c.range))),p&&(S=Se(o,r.getCurrentData().eventUiBases,p,r),m.mutatedEvents=S,De(m,a.dateProfile,r)||(w=!0,p=null,S=null,m.mutatedEvents=null)),S?r.dispatch({type:"SET_EVENT_RESIZE",state:m}):r.dispatch({type:"UNSET_EVENT_RESIZE"}),w?ae():re(),s||(p&&Q(h,a)&&(p=null),this.validMutation=p,this.mutatedRelevantEvents=S)},this.handleDragEnd=a=>{let{context:s}=this.component,l=this.eventRange.def,r=this.eventRange.instance,o=new H(s,l,r),h=this.relevantEvents,c=this.mutatedRelevantEvents;if(s.emitter.trigger("eventResizeStop",{el:this.draggingSegEl,event:o,jsEvent:a.origEvent,view:s.viewApi}),this.validMutation){let p=new H(s,c.defs[l.defId],r?c.instances[r.instanceId]:null);s.dispatch({type:"MERGE_EVENTS",eventStore:c});let S={oldEvent:o,event:p,relatedEvents:G(c,s,r),revert(){s.dispatch({type:"MERGE_EVENTS",eventStore:h})}};s.emitter.trigger("eventResize",Object.assign(Object.assign({},S),{el:this.draggingSegEl,startDelta:this.validMutation.startDelta||pe(0),endDelta:this.validMutation.endDelta||pe(0),jsEvent:a.origEvent,view:s.viewApi})),s.emitter.trigger("eventChange",S)}else s.emitter.trigger("_noEventResize");this.draggingSeg=null,this.relevantEvents=null,this.validMutation=null};let{component:t}=e,i=this.dragging=new X(e.el);i.pointer.selector=".fc-event-resizer",i.touchScrollAllowed=!1,i.autoScroller.isEnabled=t.context.options.dragScroll;let n=this.hitDragging=new K(this.dragging,le(e));n.emitter.on("pointerdown",this.handlePointerDown),n.emitter.on("dragstart",this.handleDragStart),n.emitter.on("hitupdate",this.handleHitUpdate),n.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}querySegEl(e){return _(e.subjectEl,".fc-event")}}function Ft(d,e,t,i){let n=d.context.dateEnv,a=d.dateSpan.range.start,s=e.dateSpan.range.start,l=we(a,s,n,d.largeUnit);if(t){if(n.add(i.start,l)<i.end)return{startDelta:l}}else if(n.add(i.end,l)>i.start)return{endDelta:l};return null}class $t{constructor(e){this.context=e,this.isRecentPointerDateSelect=!1,this.matchesCancel=!1,this.matchesEvent=!1,this.onSelect=i=>{i.jsEvent&&(this.isRecentPointerDateSelect=!0)},this.onDocumentPointerDown=i=>{let n=this.context.options.unselectCancel,a=Be(i.origEvent);this.matchesCancel=!!_(a,n),this.matchesEvent=!!_(a,O.SELECTOR)},this.onDocumentPointerUp=i=>{let{context:n}=this,{documentPointer:a}=this,s=n.getCurrentData();if(!a.wasTouchScroll){if(s.dateSelection&&!this.isRecentPointerDateSelect){let l=n.options.unselectAuto;l&&(!l||!this.matchesCancel)&&n.calendarApi.unselect(i)}s.eventSelection&&!this.matchesEvent&&n.dispatch({type:"UNSELECT_EVENT"})}this.isRecentPointerDateSelect=!1};let t=this.documentPointer=new Ce(document);t.shouldIgnoreMove=!0,t.shouldWatchScroll=!1,t.emitter.on("pointerdown",this.onDocumentPointerDown),t.emitter.on("pointerup",this.onDocumentPointerUp),e.emitter.on("select",this.onSelect)}destroy(){this.context.emitter.off("select",this.onSelect),this.documentPointer.destroy()}}const Gt={fixedMirrorParent:R},zt={dateClick:R,eventDragStart:R,eventDragStop:R,eventDrop:R,eventResizeStart:R,eventResizeStop:R,eventResize:R,drop:R,eventReceive:R,eventLeave:R};oe.dataAttrPrefix="";var Bt=We({name:"@fullcalendar/interaction",componentInteractions:[Ut,Yt,O,qt],calendarInteractions:[$t],elementDraggingImpl:X,optionRefiners:Gt,listenerRefiners:zt});const Kt={class:"modal-content edit-modal-content"},Qt={class:"modal-title"},Zt={class:"edit-form"},Jt={class:"form-group"},ei=["value"],ti={key:0,class:"form-group time-display"},ii={class:"time-info"},si={class:"time-value"},ni={class:"time-info"},li={class:"time-value"},ri={key:1,class:"custom-inputs"},ai={class:"form-group"},oi={class:"form-group time-inputs"},di={class:"form-group time-inputs"},ci={class:"modal-actions"},hi=["disabled"],F="__custom__",ui={__name:"EditScheduleModal",props:{show:{type:Boolean,default:!1},date:{type:[String,Object],default:null},dayType:{type:String,default:"weekday"},currentSchedule:{type:Object,default:()=>({})}},emits:["close","save"],setup(d,{emit:e}){const t=d,i=e,{scheduleDataSets:n,scheduleUpdateDate:a}=Et(),s=b(""),l=b(""),r=b(""),o=b(""),h=b(""),c=b(""),p=A(()=>s.value===F),S=A(()=>p.value?o.value.trim()!=="":s.value!==""),w=A(()=>{if(!t.date)return"予定を編集";const f=x(t.date);return`${St(f)}（${Dt(f)}）`}),m=A(()=>{if(!t.date||!n.value)return null;const f=x(t.date);return a.value&&Tt(f,a.value)?n.value.next:n.value.default}),D=A(()=>{if(!m.value)return[];let f;switch(t.dayType){case"saturday":f=m.value.saturday||[];break;case"holiday":f=m.value.holiday||[];break;default:f=m.value.weekday||[]}const u=new Map;return f.forEach(E=>{E.s&&!u.has(E.s)&&u.set(E.s,{subject:E.s,startTime:E.sT||"",endTime:E.eT||""})}),Array.from(u.values()).sort((E,N)=>E.subject.localeCompare(N.subject,"ja"))});function j(){if(s.value===F){l.value="",r.value="";return}const f=D.value.find(u=>u.subject===s.value);f?(l.value=f.startTime,r.value=f.endTime):(l.value="",r.value="")}function I(){if(!S.value)return;const f=p.value?{subject:o.value.trim(),startTime:h.value,endTime:c.value}:{subject:s.value,startTime:l.value,endTime:r.value};i("save",{date:t.date,subject:f.subject,startTime:f.startTime,endTime:f.endTime})}function C(f){f.target.id==="editScheduleModal"&&i("close")}return fe([()=>t.show,()=>t.date,D],([f])=>{if(f&&t.currentSchedule){const u=t.currentSchedule.subject||"",E=D.value.find(Y=>Y.subject===u),N=!!E,Z=N&&((t.currentSchedule.startTime||"")!==(E.startTime||"")||(t.currentSchedule.endTime||"")!==(E.endTime||""));u&&(!N||Z)?(s.value=F,o.value=u,h.value=t.currentSchedule.startTime||"",c.value=t.currentSchedule.endTime||"",l.value="",r.value=""):(s.value=u,l.value=(E==null?void 0:E.startTime)||t.currentSchedule.startTime||"",r.value=(E==null?void 0:E.endTime)||t.currentSchedule.endTime||"",o.value="",h.value="",c.value="")}else f||(s.value="",l.value="",r.value="",o.value="",h.value="",c.value="")}),(f,u)=>(U(),V("div",{id:"editScheduleModal",class:Ye(["modal",{hidden:!d.show}]),onClick:C},[y("div",Kt,[y("h3",Qt,k(w.value),1),y("div",Zt,[y("div",Jt,[u[6]||(u[6]=y("label",{for:"editSubject"},"予定名:",-1)),W(y("select",{id:"editSubject","onUpdate:modelValue":u[0]||(u[0]=E=>s.value=E),onChange:j,class:"edit-select"},[u[5]||(u[5]=y("option",{value:"",disabled:""},"予定を選択",-1)),y("option",{value:F},"カスタム(自分で入力)"),(U(!0),V(Ve,null,Ue(D.value,E=>(U(),V("option",{key:E.subject,value:E.subject},k(E.subject),9,ei))),128))],544),[[Ne,s.value]])]),s.value&&!p.value?(U(),V("div",ti,[y("div",ii,[u[7]||(u[7]=y("span",{class:"time-label"},"開始:",-1)),y("span",si,k(l.value||"なし"),1)]),y("div",ni,[u[8]||(u[8]=y("span",{class:"time-label"},"終了:",-1)),y("span",li,k(r.value||"なし"),1)])])):he("",!0),p.value?(U(),V("div",ri,[y("div",ai,[u[9]||(u[9]=y("label",{for:"customSubject"},"予定名:",-1)),W(y("input",{id:"customSubject","onUpdate:modelValue":u[1]||(u[1]=E=>o.value=E),type:"text",class:"edit-input",placeholder:"予定名を入力"},null,512),[[ee,o.value]])]),y("div",oi,[u[10]||(u[10]=y("label",{for:"customStartTime"},"開始時間:",-1)),W(y("input",{id:"customStartTime","onUpdate:modelValue":u[2]||(u[2]=E=>h.value=E),type:"time",class:"edit-input"},null,512),[[ee,h.value]])]),y("div",di,[u[11]||(u[11]=y("label",{for:"customEndTime"},"終了時間:",-1)),W(y("input",{id:"customEndTime","onUpdate:modelValue":u[3]||(u[3]=E=>c.value=E),type:"time",class:"edit-input"},null,512),[[ee,c.value]])])])):he("",!0),y("div",ci,[y("button",{class:"cancel-btn",onClick:u[4]||(u[4]=E=>f.$emit("close"))}," キャンセル "),y("button",{class:"save-btn",onClick:I,disabled:!S.value}," 保存 ",8,hi)])])])],2))}},gi=be(ui,[["__scopeId","data-v-b6c404d7"]]),pi={class:"calendar-container"},vi={__name:"CalendarView",props:{initialDate:{type:[Date,Object]},startPosition:{type:Number,required:!1},events:{type:Array,default:()=>[]}},emits:["datesSet","scheduleEdited"],setup(d,{emit:e}){const t=d,i=e,{isHoliday:n,getHolidayName:a}=yt(),s=wt(),{getEditedSchedule:l,saveEditedSchedule:r,removeEditedSchedule:o}=s,{isEditsHidden:h}=ue(s),c=bt(),{eventConfig:p}=ue(c),S=b(void 0),w=b(void 0),m=b(void 0),D=b(!1),j=b(null),I=b("weekday"),C=b({});let f=null,u=null;const E=A(()=>{var v;const g=(v=p.value)==null?void 0:v.events;return g?{...g.default,...g.edited}:{}}),N=A(()=>t.events.map(g=>{var P;if(h.value)return{...g,extendedProps:{...g.extendedProps,isEdited:!1}};const v=ve(g.start),T=l(v);if(T){const M=T.startTime||T.endTime?`${T.subject}
${T.startTime} - 
${T.endTime}`:T.subject,L=((P=E.value)==null?void 0:P.color)||g.color;return{...g,title:M,color:L,extendedProps:{...g.extendedProps,isEdited:!0,editedSubject:T.subject,startTime:T.startTime,endTime:T.endTime}}}return{...g,extendedProps:{...g.extendedProps,isEdited:!1}}}));function Z(g,v){(v==null?void 0:v.isPrimary)!==!1&&((v==null?void 0:v.pointerType)==="mouse"&&(v==null?void 0:v.button)!==0||(u={event:g.event,jsEvent:v},f=setTimeout(()=>{u&&Pe(u.event)},Rt)))}function Y(){f&&(clearTimeout(f),f=null),u=null}function Pe(g){const v=x(g.start),T=ve(v);let P="weekday";n(v)||v.day()===0?P="holiday":v.day()===6&&(P="saturday");const M=g.extendedProps||{};let L={};M.isEdited?L={subject:M.editedSubject,startTime:M.startTime,endTime:M.endTime}:L={subject:g.title.split(`
`)[0]||"",startTime:M.startTime||"",endTime:M.endTime||""},j.value=T,I.value=P,C.value=L,D.value=!0}function J(){D.value=!1,j.value=null,C.value={}}function xe(g){r(g.date,{subject:g.subject,startTime:g.startTime,endTime:g.endTime}),J(),i("scheduleEdited",g)}function Le(g){o(g),J(),i("scheduleEdited",{date:g,removed:!0})}const Ae=A(()=>({plugins:[mt,Bt],initialView:q.INITIAL_VIEW,initialDate:t.initialDate?t.initialDate:void 0,locale:q.LOCALE,events:N.value,aspectRatio:q.DEFAULT_ASPECT_RATIO,height:q.HEIGHT,selectable:!1,editable:!1,dayCellClassNames:g=>{const v=x(g.date),T=[];return n(v)&&T.push("holiday"),v.day()===6&&T.push("fc-day-sat"),v.day()===0&&T.push("fc-day-sun"),Ct(v,Mt())&&T.push("today-highlight"),T},eventContent:g=>{const{event:v}=g;let[T,P="",M=""]=v.title.split(`
`);const{shiftIndex:L,isEdited:de}=v.extendedProps,He=x(v.start),ce=a(He),_e=ce?`${L+1} ${ce}`:`${L+1}`;return{html:`
        <div class="event-title">${de?"✎ ":""}${T}</div>
        ${P?`<div class="event-time">${P}</div>`:""}
        ${M?`<div class="event-time">${M}</div>`:""}
        <div class="event-meta">${_e}</div>
      `}},eventDidMount:g=>{const v=g.el;v.addEventListener("pointerdown",T=>Z(g,T)),v.addEventListener("pointerup",Y),v.addEventListener("pointerleave",Y),v.addEventListener("pointercancel",Y),v.classList.add("long-press-enabled")},datesSet:g=>{const v=x(g.start),T=x(g.end);(!w.value||!m.value||!v.isSame(w.value)||!T.isSame(m.value))&&(w.value=v,m.value=T,i("datesSet",{start:v,end:T}))}}));return fe([()=>t.startPosition,()=>t.initialDate],()=>{w.value&&m.value&&i("datesSet",{start:w.value,end:m.value})}),Xe(()=>{f&&clearTimeout(f)}),Oe(()=>{setTimeout(()=>{if(S.value){const g=S.value.getApi();w.value=x(g.view.activeStart),m.value=x(g.view.activeEnd),i("datesSet",{start:w.value,end:m.value})}},0)}),(g,v)=>(U(),V("div",pi,[ge(ke(ft),{ref_key:"calendarRef",ref:S,options:Ae.value},null,8,["options"]),ge(gi,{show:D.value,date:j.value,"day-type":I.value,"current-schedule":C.value,onClose:J,onSave:xe,onRemove:Le},null,8,["show","date","day-type","current-schedule"])]))}},Ti=be(vi,[["__scopeId","data-v-edcbc609"]]);export{Ti as default};
