import{b as S,e as b,w as q,f as o,o as r,g as s,l as L,x as n,D as k,p as x,I as V,J as C,G as E,F as M,q as R,n as F,t as g}from"./vendor-CnP4LbDf.js";import{u as N,_ as Q}from"./index-B_XrOJYt.js";import"./utils-BuJoAw0M.js";function $(){const{scheduleDataSets:T,scheduleUpdateDate:v}=N(),i=S(""),u=S([]),l=S("current"),h=S("weekday"),y=S(!1),D=b(()=>v.value!==void 0),d=b(()=>T.value?D.value&&l.value==="next"?T.value.next:T.value.default:null),m=b(()=>{if(!d.value)return[];switch(h.value){case"saturday":return d.value.saturday||[];case"holiday":return d.value.holiday||[];default:return d.value.weekday||[]}}),U=b(()=>{if(!m.value)return[];const a=new Set;return m.value.forEach(c=>{c.s&&c.s.trim()&&a.add(c.s.trim())}),Array.from(a).sort()}),_=b(()=>{if(!i.value.trim())return[];const a=i.value.toLowerCase().trim();return U.value.filter(c=>c.toLowerCase().includes(a)).slice(0,10)});function p(){const a=i.value.trim();if(y.value=!0,!a){u.value=[];return}if(!m.value){u.value=[];return}const c=a.toLowerCase(),t=[];m.value.forEach((e,f)=>{e.s&&e.s.toLowerCase().includes(c)&&t.push({subject:e.s,startTime:e.sT||"",endTime:e.eT||"",position:f+1,scheduleType:l.value,dayType:h.value})}),t.sort((e,f)=>e.position-f.position),u.value=t}function B(a){l.value=a,i.value.trim()&&p()}function I(a){h.value=a,i.value.trim()&&p()}function w(){i.value="",u.value=[],y.value=!1}function j(){w(),l.value="current",h.value="weekday"}return q(T,()=>{i.value.trim()&&p()}),q(D,a=>{a&&(l.value="current")},{immediate:!0}),{searchQuery:i,searchResults:u,selectedScheduleType:l,selectedDayType:h,hasSearched:y,showScheduleTypeSelector:D,filteredSuggestions:_,allSuggestions:U,currentScheduleData:d,currentDayTypeData:m,performSearch:p,updateScheduleType:B,updateDayType:I,clearSearch:w,resetSearch:j}}const z={id:"searchSection",class:"control-group"},A={key:0,class:"form-group"},G={class:"radio-group"},J={class:"form-group"},H={class:"radio-group"},K={class:"form-group"},O={class:"search-input-container"},P={key:0,class:"suggestions-dropdown"},W=["onMousedown"],X={key:1,class:"search-results"},Y={class:"results-list"},Z={class:"result-subject"},ee={class:"result-details"},te={key:0,class:"result-time"},se={key:1,class:"result-time"},le={key:2,class:"result-time"},ae={class:"result-position"},ue={key:2,class:"no-results"},ne={__name:"SearchSection",setup(T){const{searchQuery:v,searchResults:i,selectedScheduleType:u,selectedDayType:l,showScheduleTypeSelector:h,filteredSuggestions:y,hasSearched:D,performSearch:d,updateScheduleType:m,updateDayType:U}=$(),_=S(!1),p=S(-1);function B(){p.value=-1,d()}function I(){m(u.value),v.value.trim()&&d()}function w(){U(l.value),v.value.trim()&&d()}function j(c){v.value=c,_.value=!1,d()}function a(){setTimeout(()=>{_.value=!1},150)}return q(y,()=>{p.value=-1}),(c,t)=>(r(),o("fieldset",z,[t[13]||(t[13]=s("legend",null,"検索",-1)),n(h)?(r(),o("div",A,[s("div",G,[s("label",null,[k(s("input",{type:"radio",value:"current","onUpdate:modelValue":t[0]||(t[0]=e=>C(u)?u.value=e:null),onChange:I},null,544),[[V,n(u)]]),t[7]||(t[7]=x(" 現交番表 "))]),s("label",null,[k(s("input",{type:"radio",value:"next","onUpdate:modelValue":t[1]||(t[1]=e=>C(u)?u.value=e:null),onChange:I},null,544),[[V,n(u)]]),t[8]||(t[8]=x(" 新交番表 "))])])])):L("",!0),s("div",J,[s("div",H,[s("label",null,[k(s("input",{type:"radio",value:"weekday","onUpdate:modelValue":t[2]||(t[2]=e=>C(l)?l.value=e:null),onChange:w},null,544),[[V,n(l)]]),t[9]||(t[9]=x(" 平日 "))]),s("label",null,[k(s("input",{type:"radio",value:"saturday","onUpdate:modelValue":t[3]||(t[3]=e=>C(l)?l.value=e:null),onChange:w},null,544),[[V,n(l)]]),t[10]||(t[10]=x(" 土曜 "))]),s("label",null,[k(s("input",{type:"radio",value:"holiday","onUpdate:modelValue":t[4]||(t[4]=e=>C(l)?l.value=e:null),onChange:w},null,544),[[V,n(l)]]),t[11]||(t[11]=x(" 日祝 "))])])]),s("div",K,[s("div",O,[k(s("input",{type:"text",id:"searchInput","onUpdate:modelValue":t[5]||(t[5]=e=>C(v)?v.value=e:null),onInput:B,onFocus:t[6]||(t[6]=e=>_.value=!0),onBlur:a,placeholder:"予定名で検索...",class:"search-input",autocomplete:"off"},null,544),[[E,n(v)]]),_.value&&n(y).length>0?(r(),o("div",P,[(r(!0),o(M,null,R(n(y),(e,f)=>(r(),o("div",{key:f,onMousedown:oe=>j(e),class:F(["suggestion-item",{highlighted:f===p.value}])},g(e),43,W))),128))])):L("",!0)])]),n(i).length>0?(r(),o("div",X,[t[12]||(t[12]=s("div",{class:"results-header"},"検索結果:",-1)),s("div",Y,[(r(!0),o(M,null,R(n(i),(e,f)=>(r(),o("div",{key:f,class:"result-item"},[s("div",Z,g(e.subject),1),s("div",ee,[e.startTime&&e.endTime?(r(),o("span",te,g(e.startTime)+" - "+g(e.endTime),1)):e.startTime?(r(),o("span",se,g(e.startTime),1)):e.endTime?(r(),o("span",le,g(e.endTime),1)):L("",!0),s("span",ae,"コマ"+g(e.position),1)])]))),128))])])):n(v)&&n(D)?(r(),o("div",ue," 該当する予定が見つかりませんでした ")):L("",!0)]))}},ce=Q(ne,[["__scopeId","data-v-0b520186"]]);export{ce as default};
