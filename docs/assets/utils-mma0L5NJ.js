function jt(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Ft(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var a=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};a.prototype=e.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var h=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(a,n,h.get?h:{enumerable:!0,get:function(){return t[n]}})}),a}var nt={exports:{}},Pt=nt.exports,yt;function ne(){return yt||(yt=1,function(t,e){(function(a,n){t.exports=n()})(Pt,function(){var a=1e3,n=6e4,h=36e5,s="millisecond",m="second",N="minute",w="hour",f="day",A="week",M="month",Z="quarter",C="year",H="date",U="Invalid Date",et=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,at=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,j={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(u){var o=["th","st","nd","rd"],r=u%100;return"["+u+(o[(r-20)%10]||o[r]||o[0])+"]"}},G=function(u,o,r){var l=String(u);return!l||l.length>=o?u:""+Array(o+1-l.length).join(r)+u},Q={s:G,z:function(u){var o=-u.utcOffset(),r=Math.abs(o),l=Math.floor(r/60),d=r%60;return(o<=0?"+":"-")+G(l,2,"0")+":"+G(d,2,"0")},m:function u(o,r){if(o.date()<r.date())return-u(r,o);var l=12*(r.year()-o.year())+(r.month()-o.month()),d=o.clone().add(l,M),c=r-d<0,g=o.clone().add(l+(c?-1:1),M);return+(-(l+(r-d)/(c?d-g:g-d))||0)},a:function(u){return u<0?Math.ceil(u)||0:Math.floor(u)},p:function(u){return{M,y:C,w:A,d:f,D:H,h:w,m:N,s:m,ms:s,Q:Z}[u]||String(u||"").toLowerCase().replace(/s$/,"")},u:function(u){return u===void 0}},k="en",F={};F[k]=j;var y="$isDayjsObject",O=function(u){return u instanceof p||!(!u||!u[y])},x=function u(o,r,l){var d;if(!o)return k;if(typeof o=="string"){var c=o.toLowerCase();F[c]&&(d=c),r&&(F[c]=r,d=c);var g=o.split("-");if(!d&&g.length>1)return u(g[0])}else{var T=o.name;F[T]=o,d=T}return!l&&d&&(k=d),d||!l&&k},S=function(u,o){if(O(u))return u.clone();var r=typeof o=="object"?o:{};return r.date=u,r.args=arguments,new p(r)},i=Q;i.l=x,i.i=O,i.w=function(u,o){return S(u,{locale:o.$L,utc:o.$u,x:o.$x,$offset:o.$offset})};var p=function(){function u(r){this.$L=x(r.locale,null,!0),this.parse(r),this.$x=this.$x||r.x||{},this[y]=!0}var o=u.prototype;return o.parse=function(r){this.$d=function(l){var d=l.date,c=l.utc;if(d===null)return new Date(NaN);if(i.u(d))return new Date;if(d instanceof Date)return new Date(d);if(typeof d=="string"&&!/Z$/i.test(d)){var g=d.match(et);if(g){var T=g[2]-1||0,b=(g[7]||"0").substring(0,3);return c?new Date(Date.UTC(g[1],T,g[3]||1,g[4]||0,g[5]||0,g[6]||0,b)):new Date(g[1],T,g[3]||1,g[4]||0,g[5]||0,g[6]||0,b)}}return new Date(d)}(r),this.init()},o.init=function(){var r=this.$d;this.$y=r.getFullYear(),this.$M=r.getMonth(),this.$D=r.getDate(),this.$W=r.getDay(),this.$H=r.getHours(),this.$m=r.getMinutes(),this.$s=r.getSeconds(),this.$ms=r.getMilliseconds()},o.$utils=function(){return i},o.isValid=function(){return this.$d.toString()!==U},o.isSame=function(r,l){var d=S(r);return this.startOf(l)<=d&&d<=this.endOf(l)},o.isAfter=function(r,l){return S(r)<this.startOf(l)},o.isBefore=function(r,l){return this.endOf(l)<S(r)},o.$g=function(r,l,d){return i.u(r)?this[l]:this.set(d,r)},o.unix=function(){return Math.floor(this.valueOf()/1e3)},o.valueOf=function(){return this.$d.getTime()},o.startOf=function(r,l){var d=this,c=!!i.u(l)||l,g=i.p(r),T=function(W,L){var q=i.w(d.$u?Date.UTC(d.$y,L,W):new Date(d.$y,L,W),d);return c?q:q.endOf(f)},b=function(W,L){return i.w(d.toDate()[W].apply(d.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(L)),d)},v=this.$W,I=this.$M,R=this.$D,$="set"+(this.$u?"UTC":"");switch(g){case C:return c?T(1,0):T(31,11);case M:return c?T(1,I):T(0,I+1);case A:var J=this.$locale().weekStart||0,K=(v<J?v+7:v)-J;return T(c?R-K:R+(6-K),I);case f:case H:return b($+"Hours",0);case w:return b($+"Minutes",1);case N:return b($+"Seconds",2);case m:return b($+"Milliseconds",3);default:return this.clone()}},o.endOf=function(r){return this.startOf(r,!1)},o.$set=function(r,l){var d,c=i.p(r),g="set"+(this.$u?"UTC":""),T=(d={},d[f]=g+"Date",d[H]=g+"Date",d[M]=g+"Month",d[C]=g+"FullYear",d[w]=g+"Hours",d[N]=g+"Minutes",d[m]=g+"Seconds",d[s]=g+"Milliseconds",d)[c],b=c===f?this.$D+(l-this.$W):l;if(c===M||c===C){var v=this.clone().set(H,1);v.$d[T](b),v.init(),this.$d=v.set(H,Math.min(this.$D,v.daysInMonth())).$d}else T&&this.$d[T](b);return this.init(),this},o.set=function(r,l){return this.clone().$set(r,l)},o.get=function(r){return this[i.p(r)]()},o.add=function(r,l){var d,c=this;r=Number(r);var g=i.p(l),T=function(I){var R=S(c);return i.w(R.date(R.date()+Math.round(I*r)),c)};if(g===M)return this.set(M,this.$M+r);if(g===C)return this.set(C,this.$y+r);if(g===f)return T(1);if(g===A)return T(7);var b=(d={},d[N]=n,d[w]=h,d[m]=a,d)[g]||1,v=this.$d.getTime()+r*b;return i.w(v,this)},o.subtract=function(r,l){return this.add(-1*r,l)},o.format=function(r){var l=this,d=this.$locale();if(!this.isValid())return d.invalidDate||U;var c=r||"YYYY-MM-DDTHH:mm:ssZ",g=i.z(this),T=this.$H,b=this.$m,v=this.$M,I=d.weekdays,R=d.months,$=d.meridiem,J=function(L,q,tt,it){return L&&(L[q]||L(l,c))||tt[q].slice(0,it)},K=function(L){return i.s(T%12||12,L,"0")},W=$||function(L,q,tt){var it=L<12?"AM":"PM";return tt?it.toLowerCase():it};return c.replace(at,function(L,q){return q||function(tt){switch(tt){case"YY":return String(l.$y).slice(-2);case"YYYY":return i.s(l.$y,4,"0");case"M":return v+1;case"MM":return i.s(v+1,2,"0");case"MMM":return J(d.monthsShort,v,R,3);case"MMMM":return J(R,v);case"D":return l.$D;case"DD":return i.s(l.$D,2,"0");case"d":return String(l.$W);case"dd":return J(d.weekdaysMin,l.$W,I,2);case"ddd":return J(d.weekdaysShort,l.$W,I,3);case"dddd":return I[l.$W];case"H":return String(T);case"HH":return i.s(T,2,"0");case"h":return K(1);case"hh":return K(2);case"a":return W(T,b,!0);case"A":return W(T,b,!1);case"m":return String(b);case"mm":return i.s(b,2,"0");case"s":return String(l.$s);case"ss":return i.s(l.$s,2,"0");case"SSS":return i.s(l.$ms,3,"0");case"Z":return g}return null}(L)||g.replace(":","")})},o.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},o.diff=function(r,l,d){var c,g=this,T=i.p(l),b=S(r),v=(b.utcOffset()-this.utcOffset())*n,I=this-b,R=function(){return i.m(g,b)};switch(T){case C:c=R()/12;break;case M:c=R();break;case Z:c=R()/3;break;case A:c=(I-v)/6048e5;break;case f:c=(I-v)/864e5;break;case w:c=I/h;break;case N:c=I/n;break;case m:c=I/a;break;default:c=I}return d?c:i.a(c)},o.daysInMonth=function(){return this.endOf(M).$D},o.$locale=function(){return F[this.$L]},o.locale=function(r,l){if(!r)return this.$L;var d=this.clone(),c=x(r,l,!0);return c&&(d.$L=c),d},o.clone=function(){return i.w(this.$d,this)},o.toDate=function(){return new Date(this.valueOf())},o.toJSON=function(){return this.isValid()?this.toISOString():null},o.toISOString=function(){return this.$d.toISOString()},o.toString=function(){return this.$d.toUTCString()},u}(),E=p.prototype;return S.prototype=E,[["$ms",s],["$s",m],["$m",N],["$H",w],["$W",f],["$M",M],["$y",C],["$D",H]].forEach(function(u){E[u[1]]=function(o){return this.$g(o,u[0],u[1])}}),S.extend=function(u,o){return u.$i||(u(o,p,S),u.$i=!0),S},S.locale=x,S.isDayjs=O,S.unix=function(u){return S(1e3*u)},S.en=F[k],S.Ls=F,S.p={},S})}(nt)),nt.exports}var st={exports:{}},Yt=st.exports,vt;function Ht(){return vt||(vt=1,function(t){(function(){var e,a,n,h,s,m,N,w,f,A,M,Z,C,H,U,et,at,j,G,Q,k,F,y,O,x,S;j=function(i,p,E,u,o,r,l,d){var c;return c=new Date(2e3,0,1),c.setTime(i.getTime()+((((u??0)*24+(o??0))*60+(r??0))*60+(l??0))*1e3+(d??0)),c.setFullYear(c.getFullYear()+(p??0)+Math.floor((c.getMonth()+(E??0))/12)),c.setMonth(((c.getMonth()+(E??0))%12+12)%12),c},x=function(i){return j(i,0,0,0,9)},H=function(i){return j(i,0,0,0,-9)},S=function(i,p,E){return new Date(Date.UTC(i,p,E))},U=function(i,p,E){return H(S(i,p,E))},s=function(i){return x(i).getUTCDay()},h=function(i){return x(i).getUTCDate()},f=function(i){return x(i).getUTCMonth()},m=function(i){return x(i).getUTCFullYear()},N=function(i){return x(i).getUTCHours()},w=function(i){return x(i).getUTCMinutes()},y=function(i,p){return function(E){return U(E,i-1,p)}},A=function(i,p){return function(E){var u,o;return o=1,u=U(E,i-1,1),j(u,0,0,(7-(s(u)-o))%7+(p-1)*7)}},F=function(i){return new Date(-6558667e5+31556940400*(i-1949))},k=function(i){var p;return p=F(i),U(i,f(p),h(p))},Q=function(i){var p;return(p={1603:23,2074:23,2355:23,2384:22}[i])?U(i,8,p):new Date(-67131691e4+3155691e4*(i-1948))},G=function(i){var p;return p=Q(i),U(i,f(p),h(p))},e=[["元日",y(1,1),1949],["成人の日",y(1,15),1949,1999],["成人の日",A(1,2),2e3],["建国記念の日",y(2,11),1967],["天皇誕生日",y(2,23),2020],["昭和天皇の大喪の礼",y(2,24),1989,1989],["春分の日",k,1949],["皇太子明仁親王の結婚の儀",y(4,10),1959,1959],["天皇誕生日",y(4,29),1949,1988],["みどりの日",y(4,29),1989,2006],["昭和の日",y(4,29),2007],["即位の日",y(5,1),2019,2019],["憲法記念日",y(5,3),1949],["みどりの日",y(5,4),2007],["こどもの日",y(5,5),1949],["皇太子徳仁親王の結婚の儀",y(6,9),1993,1993],["海の日",y(7,20),1996,2002],["海の日",A(7,3),2003,2019],["海の日",y(7,23),2020,2020],["海の日",y(7,22),2021,2021],["海の日",A(7,3),2022],["山の日",y(8,11),2016,2019],["山の日",y(8,10),2020,2020],["山の日",y(8,8),2021,2021],["山の日",y(8,11),2022],["敬老の日",y(9,15),1966,2002],["敬老の日",A(9,3),2003],["秋分の日",G,1948],["体育の日",y(10,10),1966,1999],["体育の日",A(10,2),2e3,2019],["スポーツの日",y(7,24),2020,2020],["スポーツの日",y(7,23),2021,2021],["スポーツの日",A(10,2),2022],["即位礼正殿の儀",y(10,22),2019,2019],["文化の日",y(11,3),1948],["即位礼正殿の儀",y(11,12),1990,1990],["勤労感謝の日",y(11,23),1948],["天皇誕生日",y(12,23),1989,2018]],a=function(i){var p,E;if(E=0,i<U(1973,3,29)||s(i)!==E)return null;if(p=j(i,0,0,1),!C(p,!1))return p;if(i<U(2007,0,1))return null;for(;;)if(p=j(p,0,0,1),!C(p,!1))return p},et=function(i){var p,E,u;return m(i)<1988||!C(j(i,0,0,2),!1)||(u=0,E=1,p=j(i,0,0,1),C(p,!1)||s(p)===u||s(p)===E)?null:p},M={true:{},false:{}},n=function(i,p){var E,u,o,r,l,d,c,g,T,b,v,I,R,$;if(p=!!(p==null||p),E=M[p][i],E!=null)return E;for($={},l=0,g=e.length;l<g;l++)o=e[l],!(o[2]!=null&&i<o[2])&&(o[3]!=null&&o[3]<i||(r=o[1](i),r!=null&&(b=f(r)+1,u=h(r),$[[b,u]]=o[0])));M[!1][i]=$,c=[];for(v in $)v=v.split(","),r=et(U(i,v[0]-1,v[1])),r!=null&&(b=f(r)+1,u=h(r),c.push([b,u]));for(d=0,T=c.length;d<T;d++)r=c[d],$[r]="国民の休日";R={};for(v in $)I=$[v],R[v]=I,v=v.split(","),r=a(U(i,v[0]-1,v[1])),r!=null&&(b=f(r)+1,u=h(r),R[[b,u]]="振替休日");return M[!0][i]=R,M[p][i]},O=(at=t!==null?t.exports:void 0)!=null?at:this.JapaneseHolidays={},O.getHolidaysOf=function(i,p){var E,u,o,r;r=[],o=n(i,p);for(E in o)u=o[E],r.push({month:parseInt(E.split(",")[0]),date:parseInt(E.split(",")[1]),name:u});return r.sort(function(l,d){return l.month-d.month||l.date-d.date}),r},Z=function(i,p){return n(i.getFullYear(),p)[[i.getMonth()+1,i.getDate()]]},C=function(i,p){return n(m(i),p)[[f(i)+1,h(i)]]},O.isHoliday=Z,O.isHolidayAt=C,O.shiftDate=j,O.u2j=x,O.j2u=H,O.jDate=U,O.uDate=S,O.getJDay=s,O.getJDate=h,O.getJMonth=f,O.getJFullYear=m,O.getJHours=N,O.getJMinutes=w,O.__forTest={shunbunWithTime:F,shubunWithTime:Q}}).call(Yt)}(st)),st.exports}var lt,Et;function se(){if(Et)return lt;Et=1;var t=Ht();return lt=t,lt}function Bt(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ht={exports:{}};const Vt={},_t=Object.freeze(Object.defineProperty({__proto__:null,default:Vt},Symbol.toStringTag,{value:"Module"})),kt=Ft(_t);var Tt;function qt(){return Tt||(Tt=1,function(t){(function(){var e,a=0,n=[],h;for(h=0;h<256;h++)n[h]=(h+256).toString(16).substr(1);w.BUFFER_SIZE=4096,w.bin=N,w.clearBuffer=function(){e=null,a=0},w.test=function(f){return typeof f=="string"?/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(f):!1};var s;typeof crypto<"u"?s=crypto:typeof window<"u"&&typeof window.msCrypto<"u"&&(s=window.msCrypto),typeof Bt=="function"?(s=s||kt,t.exports=w):typeof window<"u"&&(window.uuid=w),w.randomBytes=function(){if(s){if(s.randomBytes)return s.randomBytes;if(s.getRandomValues)return typeof Uint8Array.prototype.slice!="function"?function(f){var A=new Uint8Array(f);return s.getRandomValues(A),Array.from(A)}:function(f){var A=new Uint8Array(f);return s.getRandomValues(A),A}}return function(f){var A,M=[];for(A=0;A<f;A++)M.push(Math.floor(Math.random()*256));return M}}();function m(f){return(!e||a+f>w.BUFFER_SIZE)&&(a=0,e=w.randomBytes(w.BUFFER_SIZE)),e.slice(a,a+=f)}function N(){var f=m(16);return f[6]=f[6]&15|64,f[8]=f[8]&63|128,f}function w(){var f=N();return n[f[0]]+n[f[1]]+n[f[2]]+n[f[3]]+"-"+n[f[4]]+n[f[5]]+"-"+n[f[6]]+n[f[7]]+"-"+n[f[8]]+n[f[9]]+"-"+n[f[10]]+n[f[11]]+n[f[12]]+n[f[13]]+n[f[14]]+n[f[15]]}})()}(ht)),ht.exports}var Jt=qt();const Wt=jt(Jt);var Gt=Object.defineProperty,Dt=Object.getOwnPropertySymbols,Xt=Object.prototype.hasOwnProperty,Zt=Object.prototype.propertyIsEnumerable,bt=(t,e,a)=>e in t?Gt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,pt=(t,e)=>{for(var a in e||(e={}))Xt.call(e,a)&&bt(t,a,e[a]);if(Dt)for(var a of Dt(e))Zt.call(e,a)&&bt(t,a,e[a]);return t};function P(t,e,a,n){if(t!=null&&t.startsWith("/")&&(t=t.substr(1)),typeof e=="string"||e instanceof Date){let h=new Date(e),s=h.getUTCFullYear()+String(h.getUTCMonth()+1).padStart(2,"0")+h.getUTCDate().toString().padStart(2,"0");return t&&(s=h.getFullYear()+String(h.getMonth()+1).padStart(2,"0")+h.getDate().toString().padStart(2,"0")),a?s:t?(s+="T"+h.getHours().toString().padStart(2,"0")+h.getMinutes().toString().padStart(2,"0")+h.getSeconds().toString().padStart(2,"0"),s):(s+="T"+h.getUTCHours().toString().padStart(2,"0")+h.getUTCMinutes().toString().padStart(2,"0")+h.getUTCSeconds().toString().padStart(2,"0")+(n?"":"Z"),s)}else if(dt(e)){let h=t?Kt(e)&&!e.tz()?e.clone().tz(t):e:n?e:e.utc();return h.format("YYYYMMDD")+(a?"":"T"+h.format("HHmmss")+(n||t?"":"Z"))}else if(ut(e)){let h=t?e.setZone(t):n?e:e.setZone("utc");return h.toFormat("yyyyLLdd")+(a?"":"T"+h.toFormat("HHmmss")+(n||t?"":"Z"))}else{let h=e;if(t)h=typeof e.tz=="function"?e.tz(t):e;else if(!n)if(typeof e.utc=="function")h=e.utc();else throw new Error("Unable to convert dayjs object to UTC value: UTC plugin is not available!");return h.format("YYYYMMDD")+(a?"":"T"+h.format("HHmmss")+(n||t?"":"Z"))}}function ct(t,e,a,n){let h="",s=(n==null?void 0:n.floating)||!1;return n!=null&&n.timezone&&(h=";TZID="+n.timezone,s=!0),e+h+":"+P(t,a,!1,s)}function D(t,e){return String(t).replace(e?/[\\"]/g:/[\\;,]/g,function(a){return"\\"+a}).replace(/(?:\r\n|\r|\n)/g,"\\n")}function Qt(t){return t.split(`\r
`).map(function(e){let a="",n=0;for(let h=0;h<e.length;h++){let s=e.charAt(h);s>="\uD800"&&s<="\uDBFF"&&(s+=e.charAt(++h));let m=new TextEncoder().encode(s).length;n+=m,n>74&&(a+=`\r
 `,n=m),a+=s}return a}).join(`\r
`)}function z(t,e,a){if(Array.isArray(e))t.x=e.map(n=>{if(Array.isArray(n))return n;if(typeof n.key!="string"||typeof n.value!="string")throw new Error("Either key or value is not a string!");if(n.key.substr(0,2)!=="X-")throw new Error("Key has to start with `X-`!");return[n.key,n.value]});else if(typeof e=="object")t.x=Object.entries(e).map(([n,h])=>{if(typeof n!="string"||typeof h!="string")throw new Error("Either key or value is not a string!");if(n.substr(0,2)!=="X-")throw new Error("Key has to start with `X-`!");return[n,h]});else if(typeof e=="string"&&typeof a=="string"){if(e.substr(0,2)!=="X-")throw new Error("Key has to start with `X-`!");t.x.push([e,a])}else return t.x.map(n=>({key:n[0],value:n[1]}))}function mt(t){let e=t.x.map(([a,n])=>a.toUpperCase()+":"+D(n,!1)).join(`\r
`);return e.length?e+`\r
`:""}function ot(t,e){let a=null;if(typeof e=="string"){let n=e.match(/^(.+) ?<([^>]+)>$/);n?a={name:n[1].trim(),email:n[2].trim()}:e.includes("@")&&(a={name:e.trim(),email:e.trim()})}else typeof e=="object"&&(a={name:e.name,email:e.email,mailto:e.mailto,sentBy:e.sentBy});if(!a&&typeof e=="string")throw new Error("`"+t+"` isn't formated correctly. See https://sebbo2002.github.io/ical-generator/develop/reference/interfaces/ICalOrganizer.html");if(!a)throw new Error("`"+t+"` needs to be a valid formed string or an object. See https://sebbo2002.github.io/ical-generator/develop/reference/interfaces/ICalOrganizer.html");if(!a.name)throw new Error("`"+t+".name` is empty!");return a}function Y(t,e){let a=Object.values(t),n=String(e).toUpperCase();if(!n||!a.includes(n))throw new Error(`Input must be one of the following: ${a.join(", ")}`);return n}function B(t,e){if(t instanceof Date&&isNaN(t.getTime())||typeof t=="string"&&isNaN(new Date(t).getTime()))throw new Error(`\`${e}\` has to be a valid date!`);if(t instanceof Date||typeof t=="string"||ut(t)&&t.isValid===!0||(dt(t)||te(t))&&t.isValid())return t;throw new Error(`\`${e}\` has to be a valid date!`)}function rt(t){return typeof t=="string"||t instanceof Date?new Date(t):ut(t)?t.toJSDate():t.toDate()}function dt(t){return t!=null&&t._isAMomentObject!=null}function Kt(t){return dt(t)&&"tz"in t&&typeof t.tz=="function"}function te(t){return typeof t=="object"&&t!==null&&!(t instanceof Date)&&!dt(t)&&!ut(t)}function ut(t){return typeof t=="object"&&t!==null&&"toJSDate"in t&&typeof t.toJSDate=="function"}function ee(t){return t!==null&&typeof t=="object"&&typeof t.asSeconds=="function"}function ft(t){return t!==null&&typeof t=="object"&&typeof t.between=="function"&&typeof t.toString=="function"}function V(t){return t?typeof t=="string"?t:t.toJSON():null}function X(t){let e="";return t<0&&(e="-",t*=-1),e+="P",t>=86400&&(e+=Math.floor(t/86400)+"D",t%=86400),!t&&e.length>1||(e+="T",t>=3600&&(e+=Math.floor(t/3600)+"H",t%=3600),t>=60&&(e+=Math.floor(t/60)+"M",t%=60),t>0?e+=t+"S":e.length<=2&&(e+="0S")),e}var Ot=(t=>(t.CHAIR="CHAIR",t.REQ="REQ-PARTICIPANT",t.OPT="OPT-PARTICIPANT",t.NON="NON-PARTICIPANT",t))(Ot||{}),It=(t=>(t.ACCEPTED="ACCEPTED",t.TENTATIVE="TENTATIVE",t.DECLINED="DECLINED",t.DELEGATED="DELEGATED",t.NEEDSACTION="NEEDS-ACTION",t))(It||{}),Rt=(t=>(t.INDIVIDUAL="INDIVIDUAL",t.GROUP="GROUP",t.RESOURCE="RESOURCE",t.ROOM="ROOM",t.UNKNOWN="UNKNOWN",t))(Rt||{}),At=class _{constructor(e,a){if(this.data={name:null,email:"",mailto:null,sentBy:null,status:null,role:"REQ-PARTICIPANT",rsvp:null,type:null,delegatedTo:null,delegatedFrom:null,x:[]},this.event=a,!this.event)throw new Error("`event` option required!");if(!e.email)throw new Error("No value for `email` in ICalAttendee given!");e.name!==void 0&&this.name(e.name),e.email!==void 0&&this.email(e.email),e.mailto!==void 0&&this.mailto(e.mailto),e.sentBy!==void 0&&this.sentBy(e.sentBy),e.status!==void 0&&this.status(e.status),e.role!==void 0&&this.role(e.role),e.rsvp!==void 0&&this.rsvp(e.rsvp),e.type!==void 0&&this.type(e.type),e.delegatedTo!==void 0&&this.delegatedTo(e.delegatedTo),e.delegatedFrom!==void 0&&this.delegatedFrom(e.delegatedFrom),e.delegatesTo&&this.delegatesTo(e.delegatesTo),e.delegatesFrom&&this.delegatesFrom(e.delegatesFrom),e.x!==void 0&&this.x(e.x)}name(e){return e===void 0?this.data.name:(this.data.name=e||null,this)}email(e){return e?(this.data.email=e,this):this.data.email}mailto(e){return e===void 0?this.data.mailto:(this.data.mailto=e||null,this)}sentBy(e){return e?(this.data.sentBy=e,this):this.data.sentBy}role(e){return e===void 0?this.data.role:(this.data.role=Y(Ot,e),this)}rsvp(e){return e===void 0?this.data.rsvp:e===null?(this.data.rsvp=null,this):(this.data.rsvp=!!e,this)}status(e){return e===void 0?this.data.status:e?(this.data.status=Y(It,e),this):(this.data.status=null,this)}type(e){return e===void 0?this.data.type:e?(this.data.type=Y(Rt,e),this):(this.data.type=null,this)}delegatedTo(e){return e===void 0?this.data.delegatedTo:e?(typeof e=="string"?this.data.delegatedTo=new _(pt({email:e},ot("delegatedTo",e)),this.event):e instanceof _?this.data.delegatedTo=e:this.data.delegatedTo=new _(e,this.event),this.data.status="DELEGATED",this):(this.data.delegatedTo=null,this.data.status==="DELEGATED"&&(this.data.status=null),this)}delegatedFrom(e){return e===void 0?this.data.delegatedFrom:(e?typeof e=="string"?this.data.delegatedFrom=new _(pt({email:e},ot("delegatedFrom",e)),this.event):e instanceof _?this.data.delegatedFrom=e:this.data.delegatedFrom=new _(e,this.event):this.data.delegatedFrom=null,this)}delegatesTo(e){let a=e instanceof _?e:this.event.createAttendee(e);return this.delegatedTo(a),a.delegatedFrom(this),a}delegatesFrom(e){let a=e instanceof _?e:this.event.createAttendee(e);return this.delegatedFrom(a),a.delegatedTo(this),a}x(e,a){if(e===void 0)return z(this.data);if(typeof e=="string"&&typeof a=="string")z(this.data,e,a);else if(typeof e=="object")z(this.data,e);else throw new Error("Either key or value is not a string!");return this}toJSON(){var e,a;return Object.assign({},this.data,{delegatedTo:((e=this.data.delegatedTo)==null?void 0:e.email())||null,delegatedFrom:((a=this.data.delegatedFrom)==null?void 0:a.email())||null,x:this.x()})}toString(){let e="ATTENDEE";if(!this.data.email)throw new Error("No value for `email` in ICalAttendee given!");return e+=";ROLE="+this.data.role,this.data.type&&(e+=";CUTYPE="+this.data.type),this.data.status&&(e+=";PARTSTAT="+this.data.status),this.data.rsvp!==null&&(e+=";RSVP="+this.data.rsvp.toString().toUpperCase()),this.data.sentBy!==null&&(e+=';SENT-BY="mailto:'+this.data.sentBy+'"'),this.data.delegatedTo&&(e+=';DELEGATED-TO="'+this.data.delegatedTo.email()+'"'),this.data.delegatedFrom&&(e+=';DELEGATED-FROM="'+this.data.delegatedFrom.email()+'"'),this.data.name&&(e+=';CN="'+D(this.data.name,!0)+'"'),this.data.email&&this.data.mailto&&(e+=";EMAIL="+D(this.data.email,!1)),this.data.x.length&&(e+=";"+this.data.x.map(([a,n])=>a.toUpperCase()+"="+D(n,!1)).join(";")),e+=":MAILTO:"+D(this.data.mailto||this.data.email,!1)+`\r
`,e}},Nt=(t=>(t.display="display",t.audio="audio",t))(Nt||{}),ae={end:"END",start:"START"},St=class{constructor(t,e){if(this.data={type:"display",trigger:-600,relatesTo:null,repeat:null,interval:null,attach:null,description:null,x:[]},this.event=e,!e)throw new Error("`event` option required!");t.type!==void 0&&this.type(t.type),"trigger"in t&&t.trigger!==void 0&&this.trigger(t.trigger),"triggerBefore"in t&&t.triggerBefore!==void 0&&this.triggerBefore(t.triggerBefore),"triggerAfter"in t&&t.triggerAfter!==void 0&&this.triggerAfter(t.triggerAfter),t.repeat&&this.repeat(t.repeat),t.attach!==void 0&&this.attach(t.attach),t.description!==void 0&&this.description(t.description),t.x!==void 0&&this.x(t.x)}type(t){if(t===void 0)return this.data.type;if(!t||!Object.keys(Nt).includes(t))throw new Error("`type` is not correct, must be either `display` or `audio`!");return this.data.type=t,this}trigger(t){if(t===void 0&&typeof this.data.trigger=="number")return-1*this.data.trigger;if(t===void 0)return this.data.trigger;if(typeof t=="number"&&isFinite(t))this.data.trigger=-1*t;else{if(!t||typeof t=="number")throw new Error("`trigger` is not correct, must be a finite number or a supported date!");this.data.trigger=B(t,"trigger")}return this}relatesTo(t){if(t===void 0)return this.data.relatesTo;if(!t)return this.data.relatesTo=null,this;if(!Object.values(ae).includes(t))throw new Error("`relatesTo` is not correct, must be either `START` or `END`!");return this.data.relatesTo=t,this}triggerAfter(t){return t===void 0?this.data.trigger:this.trigger(typeof t=="number"?-1*t:t)}triggerBefore(t){return t===void 0?this.trigger():this.trigger(t)}repeat(t){if(t===void 0)return this.data.repeat;if(!t)return this.data.repeat=null,this;if(typeof t!="object")throw new Error("`repeat` is not correct, must be an object!");if(typeof t.times!="number"||!isFinite(t.times))throw new Error("`repeat.times` is not correct, must be numeric!");if(typeof t.interval!="number"||!isFinite(t.interval))throw new Error("`repeat.interval` is not correct, must be numeric!");return this.data.repeat=t,this}attach(t){if(t===void 0)return this.data.attach;if(!t)return this.data.attach=null,this;let e=null;if(typeof t=="string")e={uri:t,mime:null};else if(typeof t=="object")e={uri:t.uri,mime:t.mime||null};else throw new Error("`attachment` needs to be a valid formed string or an object. See https://sebbo2002.github.io/ical-generator/develop/reference/classes/ICalAlarm.html#attach");if(!e.uri)throw new Error("`attach.uri` is empty!");return this.data.attach={uri:e.uri,mime:e.mime},this}description(t){return t===void 0?this.data.description:t?(this.data.description=t,this):(this.data.description=null,this)}x(t,e){if(t===void 0)return z(this.data);if(typeof t=="string"&&typeof e=="string")z(this.data,t,e);else if(typeof t=="object")z(this.data,t);else throw new Error("Either key or value is not a string!");return this}toJSON(){let t=this.trigger();return Object.assign({},this.data,{trigger:typeof t=="number"?t:V(t),x:this.x()})}toString(){var t;let e=`BEGIN:VALARM\r
`;if(e+="ACTION:"+this.data.type.toUpperCase()+`\r
`,typeof this.data.trigger=="number"&&this.data.relatesTo===null?this.data.trigger>0?e+="TRIGGER;RELATED=END:"+X(this.data.trigger)+`\r
`:e+="TRIGGER:"+X(this.data.trigger)+`\r
`:typeof this.data.trigger=="number"?e+="TRIGGER;RELATED="+((t=this.data.relatesTo)==null?void 0:t.toUpperCase())+":"+X(this.data.trigger)+`\r
`:e+="TRIGGER;VALUE=DATE-TIME:"+P(this.event.timezone(),this.data.trigger)+`\r
`,this.data.repeat){if(!this.data.repeat.times)throw new Error("No value for `repeat.times` in ICalAlarm given, but required for `interval`!");if(!this.data.repeat.interval)throw new Error("No value for `repeat.interval` in ICalAlarm given, but required for `repeat`!");e+="REPEAT:"+this.data.repeat.times+`\r
`,e+="DURATION:"+X(this.data.repeat.interval)+`\r
`}return this.data.type==="audio"&&this.data.attach&&this.data.attach.mime?e+="ATTACH;FMTTYPE="+D(this.data.attach.mime,!1)+":"+D(this.data.attach.uri,!1)+`\r
`:this.data.type==="audio"&&this.data.attach?e+="ATTACH;VALUE=URI:"+D(this.data.attach.uri,!1)+`\r
`:this.data.type==="audio"&&(e+=`ATTACH;VALUE=URI:Basso\r
`),this.data.type==="display"&&this.data.description?e+="DESCRIPTION:"+D(this.data.description,!1)+`\r
`:this.data.type==="display"&&(e+="DESCRIPTION:"+D(this.event.summary(),!1)+`\r
`),e+=mt(this.data),e+=`END:VALARM\r
`,e}},wt=class{constructor(t){if(this.data={name:""},!t.name)throw new Error("No value for `name` in ICalCategory given!");this.name(t.name)}name(t){return t===void 0?this.data.name:(this.data.name=t,this)}toJSON(){return Object.assign({},this.data)}toString(){return D(this.data.name,!1)}},Ct=(t=>(t.SECONDLY="SECONDLY",t.MINUTELY="MINUTELY",t.HOURLY="HOURLY",t.DAILY="DAILY",t.WEEKLY="WEEKLY",t.MONTHLY="MONTHLY",t.YEARLY="YEARLY",t))(Ct||{}),gt=(t=>(t.SU="SU",t.MO="MO",t.TU="TU",t.WE="WE",t.TH="TH",t.FR="FR",t.SA="SA",t))(gt||{}),Ut=(t=>(t.CONFIRMED="CONFIRMED",t.TENTATIVE="TENTATIVE",t.CANCELLED="CANCELLED",t))(Ut||{}),$t=(t=>(t.FREE="FREE",t.TENTATIVE="TENTATIVE",t.BUSY="BUSY",t.OOF="OOF",t))($t||{}),Lt=(t=>(t.TRANSPARENT="TRANSPARENT",t.OPAQUE="OPAQUE",t))(Lt||{}),xt=(t=>(t.PUBLIC="PUBLIC",t.PRIVATE="PRIVATE",t.CONFIDENTIAL="CONFIDENTIAL",t))(xt||{}),Mt=class{constructor(t,e){if(this.data={id:Wt(),sequence:0,start:new Date,end:null,recurrenceId:null,timezone:null,stamp:new Date,allDay:!1,floating:!1,repeating:null,summary:"",location:null,description:null,organizer:null,attendees:[],alarms:[],categories:[],status:null,busystatus:null,priority:null,url:null,attachments:[],transparency:null,created:null,lastModified:null,class:null,x:[]},this.calendar=e,!e)throw new Error("`calendar` option required!");t.id&&this.id(t.id),t.sequence!==void 0&&this.sequence(t.sequence),t.start&&this.start(t.start),t.end!==void 0&&this.end(t.end),t.recurrenceId!==void 0&&this.recurrenceId(t.recurrenceId),t.timezone!==void 0&&this.timezone(t.timezone),t.stamp!==void 0&&this.stamp(t.stamp),t.allDay!==void 0&&this.allDay(t.allDay),t.floating!==void 0&&this.floating(t.floating),t.repeating!==void 0&&this.repeating(t.repeating),t.summary!==void 0&&this.summary(t.summary),t.location!==void 0&&this.location(t.location),t.description!==void 0&&this.description(t.description),t.organizer!==void 0&&this.organizer(t.organizer),t.attendees!==void 0&&this.attendees(t.attendees),t.alarms!==void 0&&this.alarms(t.alarms),t.categories!==void 0&&this.categories(t.categories),t.status!==void 0&&this.status(t.status),t.busystatus!==void 0&&this.busystatus(t.busystatus),t.priority!==void 0&&this.priority(t.priority),t.url!==void 0&&this.url(t.url),t.attachments!==void 0&&this.attachments(t.attachments),t.transparency!==void 0&&this.transparency(t.transparency),t.created!==void 0&&this.created(t.created),t.lastModified!==void 0&&this.lastModified(t.lastModified),t.class!==void 0&&this.class(t.class),t.x!==void 0&&this.x(t.x)}id(t){return t===void 0?this.data.id:(this.data.id=String(t),this)}uid(t){return t===void 0?this.id():this.id(t)}sequence(t){if(t===void 0)return this.data.sequence;let e=parseInt(String(t),10);if(isNaN(e))throw new Error("`sequence` must be a number!");return this.data.sequence=t,this}start(t){if(t===void 0)return this.data.start;if(this.data.start=B(t,"start"),this.data.start&&this.data.end&&rt(this.data.start).getTime()>rt(this.data.end).getTime()){let e=this.data.start;this.data.start=this.data.end,this.data.end=e}return this}end(t){if(t===void 0)return this.data.end;if(t===null)return this.data.end=null,this;if(this.data.end=B(t,"end"),this.data.start&&this.data.end&&rt(this.data.start).getTime()>rt(this.data.end).getTime()){let e=this.data.start;this.data.start=this.data.end,this.data.end=e}return this}recurrenceId(t){return t===void 0?this.data.recurrenceId:t===null?(this.data.recurrenceId=null,this):(this.data.recurrenceId=B(t,"recurrenceId"),this)}timezone(t){return t===void 0&&this.data.timezone!==null?this.data.timezone:t===void 0?this.calendar.timezone():(this.data.timezone=t&&t!=="UTC"?t.toString():null,this.data.timezone&&(this.data.floating=!1),this)}stamp(t){return t===void 0?this.data.stamp:(this.data.stamp=B(t,"stamp"),this)}timestamp(t){return t===void 0?this.stamp():this.stamp(t)}allDay(t){return t===void 0?this.data.allDay:(this.data.allDay=!!t,this)}floating(t){return t===void 0?this.data.floating:(this.data.floating=!!t,this.data.floating&&(this.data.timezone=null),this)}repeating(t){if(t===void 0)return this.data.repeating;if(!t)return this.data.repeating=null,this;if(ft(t)||typeof t=="string")return this.data.repeating=t,this;if(this.data.repeating={freq:Y(Ct,t.freq)},t.count){if(!isFinite(t.count))throw new Error("`repeating.count` must be a finite number!");this.data.repeating.count=t.count}if(t.interval){if(!isFinite(t.interval))throw new Error("`repeating.interval` must be a finite number!");this.data.repeating.interval=t.interval}if(t.until!==void 0&&(this.data.repeating.until=B(t.until,"repeating.until")),t.byDay){let e=Array.isArray(t.byDay)?t.byDay:[t.byDay];this.data.repeating.byDay=e.map(a=>Y(gt,a))}if(t.byMonth){let e=Array.isArray(t.byMonth)?t.byMonth:[t.byMonth];this.data.repeating.byMonth=e.map(a=>{if(typeof a!="number"||a<1||a>12)throw new Error("`repeating.byMonth` contains invalid value `"+a+"`!");return a})}if(t.byMonthDay){let e=Array.isArray(t.byMonthDay)?t.byMonthDay:[t.byMonthDay];this.data.repeating.byMonthDay=e.map(a=>{if(typeof a!="number"||a<-31||a>31||a===0)throw new Error("`repeating.byMonthDay` contains invalid value `"+a+"`!");return a})}if(t.bySetPos){if(!this.data.repeating.byDay)throw"`repeating.bySetPos` must be used along with `repeating.byDay`!";let e=Array.isArray(t.bySetPos)?t.bySetPos:[t.bySetPos];this.data.repeating.bySetPos=e.map(a=>{if(typeof a!="number"||a<-366||a>366||a===0)throw"`repeating.bySetPos` contains invalid value `"+a+"`!";return a})}if(t.exclude){let e=Array.isArray(t.exclude)?t.exclude:[t.exclude];this.data.repeating.exclude=e.map((a,n)=>B(a,`repeating.exclude[${n}]`))}return t.startOfWeek&&(this.data.repeating.startOfWeek=Y(gt,t.startOfWeek)),this}summary(t){return t===void 0?this.data.summary:(this.data.summary=t?String(t):"",this)}location(t){if(t===void 0)return this.data.location;if(typeof t=="string")return this.data.location={title:t},this;if(t&&!t.title||t!=null&&t.geo&&(!isFinite(t.geo.lat)||!isFinite(t.geo.lon)))throw new Error("`location` isn't formatted correctly. See https://sebbo2002.github.io/ical-generator/develop/reference/classes/ICalEvent.html#location");return this.data.location=t||null,this}description(t){return t===void 0?this.data.description:t===null?(this.data.description=null,this):(typeof t=="string"?this.data.description={plain:t}:this.data.description=t,this)}organizer(t){return t===void 0?this.data.organizer:t===null?(this.data.organizer=null,this):(this.data.organizer=ot("organizer",t),this)}createAttendee(t){if(t instanceof At)return this.data.attendees.push(t),t;typeof t=="string"&&(t=pt({email:t},ot("data",t)));let e=new At(t,this);return this.data.attendees.push(e),e}attendees(t){return t?(t.forEach(e=>this.createAttendee(e)),this):this.data.attendees}createAlarm(t){let e=t instanceof St?t:new St(t,this);return this.data.alarms.push(e),e}alarms(t){return t?(t.forEach(e=>this.createAlarm(e)),this):this.data.alarms}createCategory(t){let e=t instanceof wt?t:new wt(t);return this.data.categories.push(e),e}categories(t){return t?(t.forEach(e=>this.createCategory(e)),this):this.data.categories}status(t){return t===void 0?this.data.status:t===null?(this.data.status=null,this):(this.data.status=Y(Ut,t),this)}busystatus(t){return t===void 0?this.data.busystatus:t===null?(this.data.busystatus=null,this):(this.data.busystatus=Y($t,t),this)}priority(t){if(t===void 0)return this.data.priority;if(t===null)return this.data.priority=null,this;if(t<0||t>9)throw new Error("`priority` is invalid, musst be 0 ≤ priority ≤ 9.");return this.data.priority=Math.round(t),this}url(t){return t===void 0?this.data.url:(this.data.url=t?String(t):null,this)}createAttachment(t){return this.data.attachments.push(t),this}attachments(t){return t?(t.forEach(e=>this.createAttachment(e)),this):this.data.attachments}transparency(t){return t===void 0?this.data.transparency:t?(this.data.transparency=Y(Lt,t),this):(this.data.transparency=null,this)}created(t){return t===void 0?this.data.created:t===null?(this.data.created=null,this):(this.data.created=B(t,"created"),this)}lastModified(t){return t===void 0?this.data.lastModified:t===null?(this.data.lastModified=null,this):(this.data.lastModified=B(t,"lastModified"),this)}class(t){return t===void 0?this.data.class:t===null?(this.data.class=null,this):(this.data.class=Y(xt,t),this)}x(t,e){return t===void 0?z(this.data):(typeof t=="string"&&typeof e=="string"&&z(this.data,t,e),typeof t=="object"&&z(this.data,t),this)}toJSON(){var t;let e=null;return ft(this.data.repeating)||typeof this.data.repeating=="string"?e=this.data.repeating.toString():this.data.repeating&&(e=Object.assign({},this.data.repeating,{until:V(this.data.repeating.until)||void 0,exclude:(t=this.data.repeating.exclude)==null?void 0:t.map(a=>V(a))})),Object.assign({},this.data,{start:V(this.data.start)||null,end:V(this.data.end)||null,recurrenceId:V(this.data.recurrenceId)||null,stamp:V(this.data.stamp)||null,created:V(this.data.created)||null,lastModified:V(this.data.lastModified)||null,repeating:e,x:this.x()})}toString(){var t,e,a,n,h;let s="";if(s+=`BEGIN:VEVENT\r
`,s+="UID:"+this.data.id+`\r
`,s+="SEQUENCE:"+this.data.sequence+`\r
`,s+="DTSTAMP:"+P(this.calendar.timezone(),this.data.stamp)+`\r
`,this.data.allDay?(s+="DTSTART;VALUE=DATE:"+P(this.calendar.timezone(),this.data.start,!0)+`\r
`,this.data.end&&(s+="DTEND;VALUE=DATE:"+P(this.calendar.timezone(),this.data.end,!0)+`\r
`),s+=`X-MICROSOFT-CDO-ALLDAYEVENT:TRUE\r
`,s+=`X-MICROSOFT-MSNCALENDAR-ALLDAYEVENT:TRUE\r
`):(s+=ct(this.timezone(),"DTSTART",this.data.start,this.data)+`\r
`,this.data.end&&(s+=ct(this.timezone(),"DTEND",this.data.end,this.data)+`\r
`)),ft(this.data.repeating)||typeof this.data.repeating=="string"){let m=this.data.repeating.toString().replace(/\r\n/g,`
`).split(`
`).filter(N=>N&&!N.startsWith("DTSTART:")).join(`\r
`);!m.includes(`\r
`)&&!m.startsWith("RRULE:")&&(m="RRULE:"+m),s+=m.trim()+`\r
`}else this.data.repeating&&(s+="RRULE:FREQ="+this.data.repeating.freq,this.data.repeating.count&&(s+=";COUNT="+this.data.repeating.count),this.data.repeating.interval&&(s+=";INTERVAL="+this.data.repeating.interval),this.data.repeating.until&&(s+=";UNTIL="+P(this.calendar.timezone(),this.data.repeating.until,!1,this.floating())),this.data.repeating.byDay&&(s+=";BYDAY="+this.data.repeating.byDay.join(",")),this.data.repeating.byMonth&&(s+=";BYMONTH="+this.data.repeating.byMonth.join(",")),this.data.repeating.byMonthDay&&(s+=";BYMONTHDAY="+this.data.repeating.byMonthDay.join(",")),this.data.repeating.bySetPos&&(s+=";BYSETPOS="+this.data.repeating.bySetPos.join(",")),this.data.repeating.startOfWeek&&(s+=";WKST="+this.data.repeating.startOfWeek),s+=`\r
`,this.data.repeating.exclude&&(this.data.allDay?s+="EXDATE;VALUE=DATE:"+this.data.repeating.exclude.map(m=>P(this.calendar.timezone(),m,!0)).join(",")+`\r
`:(s+="EXDATE",this.timezone()?s+=";TZID="+this.timezone()+":"+this.data.repeating.exclude.map(m=>P(this.timezone(),m,!1,!0)).join(",")+`\r
`:s+=":"+this.data.repeating.exclude.map(m=>P(this.timezone(),m,!1,this.floating())).join(",")+`\r
`)));return this.data.recurrenceId&&(s+=ct(this.timezone(),"RECURRENCE-ID",this.data.recurrenceId,this.data)+`\r
`),s+="SUMMARY:"+D(this.data.summary,!1)+`\r
`,this.data.transparency&&(s+="TRANSP:"+D(this.data.transparency,!1)+`\r
`),(t=this.data.location)!=null&&t.title&&(s+="LOCATION:"+D(this.data.location.title+(this.data.location.address?`
`+this.data.location.address:""),!1)+`\r
`,this.data.location.radius&&this.data.location.geo&&(s+="X-APPLE-STRUCTURED-LOCATION;VALUE=URI;"+(this.data.location.address?"X-ADDRESS="+D(this.data.location.address,!1)+";":"")+"X-APPLE-RADIUS="+D(this.data.location.radius,!1)+";X-TITLE="+D(this.data.location.title,!1)+":geo:"+D((e=this.data.location.geo)==null?void 0:e.lat,!1)+","+D((a=this.data.location.geo)==null?void 0:a.lon,!1)+`\r
`),this.data.location.geo&&(s+="GEO:"+D((n=this.data.location.geo)==null?void 0:n.lat,!1)+";"+D((h=this.data.location.geo)==null?void 0:h.lon,!1)+`\r
`)),this.data.description&&(s+="DESCRIPTION:"+D(this.data.description.plain,!1)+`\r
`,this.data.description.html&&(s+="X-ALT-DESC;FMTTYPE=text/html:"+D(this.data.description.html,!1)+`\r
`)),this.data.organizer&&(s+='ORGANIZER;CN="'+D(this.data.organizer.name,!0)+'"',this.data.organizer.sentBy&&(s+=';SENT-BY="mailto:'+D(this.data.organizer.sentBy,!0)+'"'),this.data.organizer.email&&this.data.organizer.mailto&&(s+=";EMAIL="+D(this.data.organizer.email,!1)),this.data.organizer.email&&(s+=":mailto:"+D(this.data.organizer.mailto||this.data.organizer.email,!1)),s+=`\r
`),this.data.attendees.forEach(function(m){s+=m.toString()}),this.data.alarms.forEach(function(m){s+=m.toString()}),this.data.categories.length>0&&(s+="CATEGORIES:"+this.data.categories.map(m=>m.toString()).join()+`\r
`),this.data.url&&(s+="URL;VALUE=URI:"+D(this.data.url,!1)+`\r
`),this.data.attachments.length>0&&this.data.attachments.forEach(m=>{s+="ATTACH:"+D(m,!1)+`\r
`}),this.data.status&&(s+="STATUS:"+this.data.status.toUpperCase()+`\r
`),this.data.busystatus&&(s+="X-MICROSOFT-CDO-BUSYSTATUS:"+this.data.busystatus.toUpperCase()+`\r
`),this.data.priority!==null&&(s+="PRIORITY:"+this.data.priority+`\r
`),s+=mt(this.data),this.data.created&&(s+="CREATED:"+P(this.calendar.timezone(),this.data.created)+`\r
`),this.data.lastModified&&(s+="LAST-MODIFIED:"+P(this.calendar.timezone(),this.data.lastModified)+`\r
`),this.data.class&&(s+="CLASS:"+this.data.class.toUpperCase()+`\r
`),s+=`END:VEVENT\r
`,s}},zt=(t=>(t.PUBLISH="PUBLISH",t.REQUEST="REQUEST",t.REPLY="REPLY",t.ADD="ADD",t.CANCEL="CANCEL",t.REFRESH="REFRESH",t.COUNTER="COUNTER",t.DECLINECOUNTER="DECLINECOUNTER",t))(zt||{}),ie=class{constructor(t={}){this.data={prodId:"//sebbo.net//ical-generator//EN",method:null,name:null,description:null,timezone:null,source:null,url:null,scale:null,ttl:null,events:[],x:[]},t.prodId!==void 0&&this.prodId(t.prodId),t.method!==void 0&&this.method(t.method),t.name!==void 0&&this.name(t.name),t.description!==void 0&&this.description(t.description),t.timezone!==void 0&&this.timezone(t.timezone),t.source!==void 0&&this.source(t.source),t.url!==void 0&&this.url(t.url),t.scale!==void 0&&this.scale(t.scale),t.ttl!==void 0&&this.ttl(t.ttl),t.events!==void 0&&this.events(t.events),t.x!==void 0&&this.x(t.x)}prodId(t){if(!t)return this.data.prodId;if(typeof t=="string")return this.data.prodId=t,this;if(typeof t!="object")throw new Error("`prodid` needs to be a string or an object!");if(!t.company)throw new Error("`prodid.company` is a mandatory item!");if(!t.product)throw new Error("`prodid.product` is a mandatory item!");let e=(t.language||"EN").toUpperCase();return this.data.prodId="//"+t.company+"//"+t.product+"//"+e,this}method(t){return t===void 0?this.data.method:t?(this.data.method=Y(zt,t),this):(this.data.method=null,this)}name(t){return t===void 0?this.data.name:(this.data.name=t?String(t):null,this)}description(t){return t===void 0?this.data.description:(this.data.description=t?String(t):null,this)}timezone(t){var e;return t===void 0?((e=this.data.timezone)==null?void 0:e.name)||null:(t==="UTC"?this.data.timezone=null:typeof t=="string"?this.data.timezone={name:t}:t===null?this.data.timezone=null:this.data.timezone=t,this)}source(t){return t===void 0?this.data.source:(this.data.source=t||null,this)}url(t){return t===void 0?this.data.url:(this.data.url=t||null,this)}scale(t){return t===void 0?this.data.scale:(t===null?this.data.scale=null:this.data.scale=t.toUpperCase(),this)}ttl(t){return t===void 0?this.data.ttl:(ee(t)?this.data.ttl=t.asSeconds():t&&t>0?this.data.ttl=t:this.data.ttl=null,this)}createEvent(t){let e=t instanceof Mt?t:new Mt(t,this);return this.data.events.push(e),e}events(t){return t?(t.forEach(e=>this.createEvent(e)),this):this.data.events}clear(){return this.data.events=[],this}x(t,e){if(t===void 0)return z(this.data);if(typeof t=="string"&&typeof e=="string")z(this.data,t,e);else if(typeof t=="object")z(this.data,t);else throw new Error("Either key or value is not a string!");return this}toJSON(){return Object.assign({},this.data,{timezone:this.timezone(),events:this.data.events.map(t=>t.toJSON()),x:this.x()})}length(){return this.data.events.length}toString(){var t,e;let a="";return a=`BEGIN:VCALENDAR\r
VERSION:2.0\r
`,a+="PRODID:-"+this.data.prodId+`\r
`,this.data.url&&(a+="URL:"+this.data.url+`\r
`),this.data.source&&(a+="SOURCE;VALUE=URI:"+this.data.source+`\r
`),this.data.scale&&(a+="CALSCALE:"+this.data.scale+`\r
`),this.data.method&&(a+="METHOD:"+this.data.method+`\r
`),this.data.name&&(a+="NAME:"+this.data.name+`\r
`,a+="X-WR-CALNAME:"+this.data.name+`\r
`),this.data.description&&(a+="X-WR-CALDESC:"+this.data.description+`\r
`),(t=this.data.timezone)!=null&&t.generator&&[...new Set([this.timezone(),...this.data.events.map(n=>n.timezone())])].filter(n=>n!==null&&!n.startsWith("/")).forEach(n=>{var h;if(!((h=this.data.timezone)!=null&&h.generator))return;let s=this.data.timezone.generator(n);s&&(a+=s.replace(/\r\n/g,`
`).replace(/\n/g,`\r
`).trim()+`\r
`)}),(e=this.data.timezone)!=null&&e.name&&(a+="TIMEZONE-ID:"+this.data.timezone.name+`\r
`,a+="X-WR-TIMEZONE:"+this.data.timezone.name+`\r
`),this.data.ttl&&(a+="REFRESH-INTERVAL;VALUE=DURATION:"+X(this.data.ttl)+`\r
`,a+="X-PUBLISHED-TTL:"+X(this.data.ttl)+`\r
`),this.data.events.forEach(n=>a+=n.toString()),a+=mt(this.data),a+="END:VCALENDAR",Qt(a)}};function re(t){return new ie(t)}var oe=re;export{oe as V,se as a,jt as g,ne as r};
